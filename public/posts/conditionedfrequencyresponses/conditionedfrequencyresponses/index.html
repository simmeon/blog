<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/blog/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=blog/livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Conditioned Frequency Responses | simmeon&#39;s blog</title>
<meta name="keywords" content="frequency response, control, system identification, aerospace, signal processing">
<meta name="description" content="Understanding how to find frequency responses when there are multiple correlated inputs present.">
<meta name="author" content="simmeon">
<link rel="canonical" href="https://simmeon.github.io/blog/post/">
<link crossorigin="anonymous" href="/blog/assets/css/stylesheet.54405a410796490bc874ab6181fac9b675753cc2b91375d8f882566459eca428.css" integrity="sha256-VEBaQQeWSQvIdKthgfrJtnV1PMK5E3XY&#43;IJWZFnspCg=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/blog/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/blog/posts/conditionedfrequencyresponses/conditionedfrequencyresponses/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Conditioned Frequency Responses" />
<meta property="og:description" content="Understanding how to find frequency responses when there are multiple correlated inputs present." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/blog/posts/conditionedfrequencyresponses/conditionedfrequencyresponses/" />
<meta property="og:image" content="http://localhost:1313/blog/%3Cimage%20path/url%3E" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2025-02-04T19:36:10+13:00" />
<meta property="article:modified_time" content="2025-02-04T19:36:10+13:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://localhost:1313/blog/%3Cimage%20path/url%3E" />
<meta name="twitter:title" content="Conditioned Frequency Responses"/>
<meta name="twitter:description" content="Understanding how to find frequency responses when there are multiple correlated inputs present."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/blog/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Conditioned Frequency Responses",
      "item": "http://localhost:1313/blog/posts/conditionedfrequencyresponses/conditionedfrequencyresponses/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Conditioned Frequency Responses",
  "name": "Conditioned Frequency Responses",
  "description": "Understanding how to find frequency responses when there are multiple correlated inputs present.",
  "keywords": [
    "frequency response", "control", "system identification", "aerospace", "signal processing"
  ],
  "articleBody": "\rAn example Imagine we’re looking into a system that has the following sort of form\n$$ \\ddot{y}(t) + c \\dot{y}(t) + k y(t) = x_{1}(t) + x_{2}(t) $$\nwhere \\( y \\) is our output and there are two inputs, \\( x_{1} \\) and \\( x_{2} \\). For the purpose of this example, we don’t know exactly what \\( c \\) and \\( k \\) are - the specific system we have is a bit of a mystery. What we can do, however, is measure the inputs we put into the system and then measure the output we get.\nThis is useful because we know that the frequency response of a system is\n$$ H(f) = \\frac{Y(f)}{X(f)} $$\nfor some output \\( y \\) and input \\( x \\). We know that we can get lots of useful information about how our system behaves from the frequency response - things like where natural frequencies are and whether the system will be stable at certain frequencies.\nSo let’s Fourier transform our input and output data and have a look at the frequency responses we get. And just to compare, let’s also plot the analytical frequency responses just to show that we did it right.\nFigure 1: A simple two-input, one-output linear system to introduce the problems that arise with partially correlated inputs.\nFigure 1 code\r1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 ''' A simple two-input (partically correlated), one-output linear system to introduce the problems that arise with partially correlated inputs. Last Modified: 2025-02-04 License: MIT ''' import numpy as np import matplotlib.pyplot as plt from scipy.signal import chirp, zoom_fft from scipy.integrate import odeint plt.style.use('https://github.com/dhaitz/matplotlib-stylesheets/raw/master/pitayasmoothie-dark.mplstyle') pi = np.pi # ------------------------------------------------------------------------------ # Define and simulate system # System coefficienets (this is secret don't look...) a = 2 b = 3 c = 2 d = 0.5 k = (2 * pi * 2)**2 # ~ 158 # Simulation properties T = 50 fs = 1000 N = T * fs t = np.linspace(0, T, N, endpoint=False) # Define input x1: freq sweep fmin = 0.1 fmax = 5 x1 = chirp(t, fmin, T, fmax) # Define input x2: partially correlated x2_uc = np.random.normal(0, 1, N) x2 = d * x1 + x2_uc # Define state derivative def dydt(y, t): u1 = x1[int(t * fs) - 1] u2 = x2[int(t * fs) - 1] return np.array([y[1], - k * y[0] - c * y[1] + a * u1 + b * u2]) # Simulate system y0 = [0, 0] y = odeint(dydt, y0, t) y = y[:,0] # ------------------------------------------------------------------------------ # Frequency Responses # Analytical frequency response f = np.logspace(np.log10(fmin), np.log10(fmax), N) s = 1.0j * 2 * pi * f H1y = a / (s**2 + c * s + k) H2y = b / (s**2 + c * s + k) # Estimated response Y = zoom_fft(y, [fmin, fmax], m=N, fs=fs) X1 = zoom_fft(x1, [fmin, fmax], m=N, fs=fs) X2 = zoom_fft(x2, [fmin, fmax], m=N, fs=fs) H1y_est = Y / X1 H2y_est = Y / X2 f_est = np.linspace(fmin, fmax, N) # ------------------------------------------------------------------------------ # Plotting fig = plt.figure() ax1 = fig.add_subplot(2,2,1) ax2 = fig.add_subplot(2,2,3) ax3 = fig.add_subplot(2,2,2) ax4 = fig.add_subplot(2,2,4) ax1.set_title(r'$Y / X_{1}$ Magnitude') ax1.semilogx(f, 20 * np.log10(abs(H1y)), label='Analytical') ax1.semilogx(f_est, 20 * np.log10(abs(H1y_est)), label='Estimated') ax2.set_title(r'$Y / X_{1}$ Phase') ax2.semilogx(f, np.rad2deg(np.angle(H1y)), label='Analytical') ax2.semilogx(f_est, np.rad2deg(np.angle(H1y_est)), label='Estimated') ax3.set_title(r'$Y / X_{2}$ Magnitude') ax3.semilogx(f, 20 * np.log10(abs(H2y)), label='Analytical') ax3.semilogx(f_est, 20 * np.log10(abs(H2y_est)), label='Estimated') ax4.set_title(r'$Y / X_{2}$ Phase') ax4.semilogx(f, np.rad2deg(np.angle(H2y)), label='Analytical') ax4.semilogx(f_est, np.rad2deg(np.angle(H2y_est)), label='Estimated') ax1.set_ylabel('Magnitude [dB]') ax2.set_xlabel('Frequency [Hz]') ax2.set_ylabel('Phase [deg]') ax4.set_xlabel('Frequency [Hz]') ax1.legend() ax2.legend() ax3.legend() ax4.legend() plt.show() Woah okay that’s not great…\nThe noise is expected due to what our inputs are and how the Fourier transform and frequency response is computed, but the magnitude of both our calculated frequency responses is definitely much higher than it should be.\nWhat’s going on here? As a hint of where this is going, it has to do with our two inputs being partially correlated. In this case that means that \\( x_{2} \\) is partially made up of \\( x_{1} \\).\nWhat is this all about? A frequency response gives information about how an output of a system will react to a sinusoidal input at different frequencies. They are very useful in analysing the stability and behaviour of systems. They are also central to frequency-domain system identification methods, which is what we will be interested in using them for.\nAs we already said, for some system input \\( x(t) \\) and output \\( y(t) \\), the frequency response is\n$$ H(f) = \\frac{Y(f)}{X(f)} $$\nBut this is not always entirely true. In systems where there are multiple partially correlated inputs and those inputs all affect the output, we have to be more careful about how we calculate these frequency responses. In other words, we have to condition the frequency responses to remove the effects that come from this correlation.\nThroughout this post, we will develop a very useful way to calculate frequency responses (especially for system identification) using spectral density functions. Then, we will apply this method in single-input single-output (SISO) systems. We will build up some theory on how to describe these correlation effects in multiple-input single-output (MISO) systems and see why the above equation for frequency responses is lacking. Finally, we will discuss how to change our method to condition these frequency responses so they are correct.\nStationary Random Processes We are mostly going to be interested in frequency responses for the purpose of system identification. That means we will have real measured data for \\( x(t) \\) and \\( y(t) \\). If we then want to find the frequency response, you may first think to just follow the earlier equation and Fourier transform both of these.\nAnd that would work! But it’s important to remember that we’re working with real-world measured data here, and real-world data always has a lot of noise, disturbances, and other issues that make our clean theoretical equations less useful. Take the following example in Figure 1:\nFigure 1: Seeing how noisy data can affect direct calculation of the frequency response from Fourier transforms.\nFigure 1 code\r1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 ''' Seeing how noisy data can affect direct calculation of the frequency response from Fourier transforms. Created by: simmeon Last Modified: 2025-01-25 License: MIT ''' import matplotlib.pyplot as plt import numpy as np from scipy.integrate import odeint from scipy.fft import rfft, rfftfreq plt.style.use('https://github.com/dhaitz/matplotlib-stylesheets/raw/master/pitayasmoothie-dark.mplstyle') pi = np.pi # Let's set up a simple spring, mass, damper system to mess around with. fn = 1 # natural frequency of system [Hz] zeta = 0.05 # system damping ratio wn = 2 * pi * fn # natural freq [rad/s] # We can find the analytical transfer function to get the true frequency response def H_func(f): s = 1.0j * 2 * pi * f return wn**2 / (s**2 + 2 * zeta * wn * s + wn**2) fmin = 0.1 # min frequency in response fmax = 10 # max frequency in response f_analytical = np.logspace(np.log10(fmin), np.log10(fmax), 500) # array of freqs to calculate response for H_analytical = H_func(f_analytical) # Frequency response mag_analytical = 20 * np.log10(abs(H_analytical)) # Magnitude of response (in dB) phase_analytical = np.rad2deg(np.angle(H_analytical)) # Phase of response (in deg) # Now let's create some noisy input and output data to simulate measurements # To do this we will solve the system with a frequency sweep over the range of interest (0.1 - 10 Hz) T = 20 # period to simulate system over [s] # Define our input function, a frequency sweep # NOTE: to get a correct frequency response over all frequencies of interest, the input must # necessarily contaion information on all the frequencies you are interested in. def u_func(t): f = t / T * fmax * 2 return 10 * np.sin(2 * pi * f * t) # Define the derivative function of the system (state space derivative) def dxdt(x, t): u = u_func(t) return np.array([x[1], - wn**2 * x[0] - 2 * zeta * wn * x[1] + wn**2 * u]) # Solve system N = 5000 # number of sample points t = np.linspace(0, T, N) # time array x0 = np.array([0, 0]) # initial state conditions sol = odeint(dxdt, x0, t) y = sol[:, 0] # pull out position from state as our output x = u_func(t) # get array of inputs for use later # Now we will add some output noise to simulate noisy measurements y = y + np.random.normal(0, 2, len(y)) # Then, we can fourier transform our input and output to calculate the freqency response Y = rfft(y) X = rfft(x) f_estimated = rfftfreq(N, T / N) H_estimated = Y / X # Estimated freq response from noisy data mag_estimated = 20 * np.log10(abs(H_estimated)) # Magnitude of response (in dB) phase_estimated = np.rad2deg(np.angle(H_estimated)) # Phase of response (in deg) # Plotting plt.figure(figsize=(12, 8)) # Subplot 1: Time domain response plt.subplot(3, 1, 1) plt.plot(t, y) plt.title(\"System Response (y) over Time\", fontsize=20) plt.xlabel(\"Time (s)\", fontsize=18) plt.ylabel(\"Output (y)\", fontsize=18) plt.grid(True) plt.tick_params(axis='both', which='major', labelsize=16) # Subplot 2: Bode magnitude plot plt.subplot(3, 1, 2) plt.semilogx(f_estimated, mag_estimated, label=\"Estimated\", linewidth=2) plt.semilogx(f_analytical, mag_analytical, label=\"Analytical\", linestyle='--', linewidth=2) plt.title(\"Bode Magnitude Plot\", fontsize=20) plt.ylabel(\"Magnitude (dB)\", fontsize=18) plt.legend(fontsize=16) plt.grid(True, which='both', axis='both') plt.xscale('log') plt.xlim((fmin, fmax)) plt.tick_params(axis='both', which='major', labelsize=12) # Subplot 3: Bode phase plot plt.subplot(3, 1, 3) plt.semilogx(f_estimated, phase_estimated, label=\"Estimated\", linewidth=2) plt.semilogx(f_analytical, phase_analytical, label=\"Analytical\", linestyle='--', linewidth=2) plt.title(\"Bode Phase Plot\", fontsize=20) plt.ylabel(\"Phase (Degrees)\", fontsize=18) plt.xlabel(\"Frequency (Hz)\", fontsize=18) plt.legend(fontsize=16) plt.grid(True, which='both', axis='both') plt.xscale('log') plt.xlim((fmin, fmax)) plt.tick_params(axis='both', which='major', labelsize=12) plt.tight_layout() plt.show() While the frequency response estimate is still pretty good where it matters, you can see how the noise starts to introduce larger errors as the frequency increases. What would be nice is a way of somehow modelling this noise and creating methods that are able to account for noise and let us minimise the impact of it.\nTo do this we will turn to some statistical methods and see where they can take us…\nBasics First, let’s look at the concept of a stationary random process. A random process meaning some function whose value at any given time is random. Each time index can be described by a random variable. This is good as our measurement noise can be modelled by these random variables. The random process is stationary if the probability density function of the random variable at any time is the same.\nLet’s look at an example to help. In Figure 2, we are using random normal noise as our random variable at each time \\( t_{i} \\) to generate a ‘sample function’, \\( x_{1}(t) \\), of the random process.\nIf we do this multiple times to create lots of sample functions \\( x_{k}(t), k = 1, 2, … \\), we can then estimate the probability density function of the random variable at a particular time \\( t_{i} \\). For example, if we focus on time \\( t = 0 \\), we could estimate the probability density function \\( f_{X}(x) \\) by counting how many sample functions had a value \\( x_{k}(0) \\) within certain ranges. Eg. how many had a value between 0 and 0.5? Between 0.5 and 1? Between -2 and -1.5?\nBasically we are creating a histogram of all the \\( x_{k}(0) \\) values. We can then do the same thing for every time index \\( t_{i} \\).\nFigure 2: Exploring what a stationary random process is and some useful features of it.\nFigure 2 code\r1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 ''' Exploring what a stationary random process is and some useful features of it. Created by: simmeon Last Modified: 2025-01-25 License: MIT ''' import matplotlib.pyplot as plt import numpy as np from scipy.ndimage import histogram plt.style.use('https://github.com/dhaitz/matplotlib-stylesheets/raw/master/pitayasmoothie-dark.mplstyle') # We will want to store each 'sample function' in an array x = [] N = 50 # sample length T = 10 # time period sample is over t = np.linspace(0, T, N) num_samples = 100 # number of sample functions to run for i in range(num_samples): # The stationary random process we will use is random normal noise x.append(np.random.normal(0, 1, N)) # We can then estimate the probability density function at a particular time (t) # by counting how many of the sample functions have values within a particular # range at that time. ti_data = np.zeros((N, num_samples)) pdfs = [] num_bins = 20 pdf_vals = np.linspace(-5, 5, num_bins) for i in range(N): for j in range(num_samples): ti_data[i, j] = (x[j][i]) pdfs.append(histogram(ti_data[i], -5, 5, num_bins) / num_samples) # Plotting fig= plt.figure() ax1 = fig.add_subplot(2, 2, 1) ax2 = fig.add_subplot(2, 2, 3) ax3 = fig.add_subplot(2, 2, 2) ax4 = fig.add_subplot(2, 2, 4) ax1.set_title(\"One Sample Function\", fontsize=20) ax1.set_xlabel(\"t\", fontsize=20) ax1.set_ylabel(\"x(t)\", fontsize=20) for i in range(1): ax1.plot(t, x[i], alpha=1.0) ax1.set_ylim((-4, 4)) ax2.set_title(r\"Probability Density Function for $t = 0$\", fontsize=20) ax2.set_xlabel(r\"$x(t = 0$)\", fontsize=20) ax2.set_ylabel(r\"$f_{X}(x)$\", fontsize=20) for i in range(1): ax2.plot(pdf_vals, pdfs[i], alpha=1.0) ax2.set_ylim((0, 0.3)) ax3.set_title(\"All Sample Functions\", fontsize=20) ax3.set_xlabel(\"t\", fontsize=20) ax3.set_ylabel(\"x(t)\", fontsize=20) for i in range(num_samples): ax3.plot(t, x[i], alpha=0.05) ax3.plot(t, x[0], color='yellow') ax3.set_ylim((-4, 4)) ax4.set_title(r\"Probability Density Functions for each $t_{i}$\", fontsize=20) ax4.set_xlabel(r\"$x(t_{i}$)\", fontsize=20) ax4.set_ylabel(r\"$f_{X}(x)$\", fontsize=20) for i in range(N): ax4.plot(pdf_vals, pdfs[i], alpha=0.1) ax4.plot(pdf_vals, pdfs[0], alpha=0.1) ax4.set_ylim((0, 0.3)) plt.show() Something that stands out is how the probability density function for every time index looks about the same. And, in fact, if we had worked it out analytically instead of estimating it, we would see that it is exactly the same probability density function for every time. This is the key feature that makes our random process a stationary random process.\nThis is really useful because it allows us to model a function over time in a way that doesn’t care about what specific time we are looking at. All the information about what value the function may be at any given time is encapsulated by a single probability density function that’s independant of time.\nBut why is this going to be useful? What can we do with this? And how does it relate to calculating frequency responses?\nYou might be starting to think that if we assume our input and output records are stationary random processes, we might be able to do some fancy statistical manipulation with them. Which is exactly what we will try do next…\nCorrelation Functions What kinds of things can we do with these stationary random processes? Let’s use a different, simpler example to help.\nTake the following digital signal which can either be 1 V or 0 V to represent either a 1 or 0 bit. Each bit has a length of \\( T \\) and each sample function may be offset from others. We will also assume it is random whether we see a 1 V or 0 V at any time. Figure 3 has some example sample functions of this signal.\nFigure 3: Some sample functions of our digital signal stationary random process.\nFigure 3 code\r1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 ''' Some sample functions of our digital signal stationary random process. Created by: simmeon Last Modified: 2025-01-25 License: MIT ''' import matplotlib.pyplot as plt import numpy as np plt.style.use('https://github.com/dhaitz/matplotlib-stylesheets/raw/master/pitayasmoothie-dark.mplstyle') num_bits = 10 # Calculate random series of bits bits1 = np.random.randint(0, 2, num_bits) bits2 = np.random.randint(0, 2, num_bits) bits3 = np.random.randint(0, 2, num_bits) N = 100 # Number of sample points per bit # Make length of each bit 1 s t = np.linspace(0, num_bits, num_bits * N) # sample functions x1 = [] x2 = [] x3 = [] # Make sample function have N points per bit and add offsets for bit in bits1: x1 = x1 + [bit] * N for bit in bits2: x2 = x2 + [bit] * N x2 = x2[35:] + x2[:35] # offset for bit in bits3: x3 = x3 + [bit] * N x3 = x3[60:] + x3[:60] # offset # Plotting fig = plt.figure() ax1 = fig.add_subplot(3,1,1) ax2 = fig.add_subplot(3,1,2) ax3 = fig.add_subplot(3,1,3) ax1.set_title('Digital Signal Sample Functions', fontsize=20) ax1.set_xticks(np.arange(0, 11, 1)) ax2.set_xticks(np.arange(0, 11, 1)) ax3.set_xticks(np.arange(0, 11, 1)) ax1.grid() ax2.grid() ax3.grid() ax1.grid(visible=True, axis='x', which='both') ax2.grid(visible=True, axis='x', which='both') ax3.grid(visible=True, axis='x', which='both') ax1.plot(t, x1) ax2.plot(t, x2) ax3.plot(t, x3) ax2.set_ylabel('Voltage (V)', fontsize=20) ax3.set_xlabel('Time (s)', fontsize=20) plt.show() Hopefully you can convince yourself that the probability density function of this random process will be the same at any time: in half the samples we will get a 1 and the other half we will get a 0. So this is another example of a stationary random process.\nOne fairly simple thing we could look at is the mean (or expected value) of this stationary random process. In more formal terms, we would use the expectation operator:\n$$ \\text{mean} = E\\{x_{k}(t)\\} $$\nSince the probability density function is the same for all time, we can also think of the expected value as the integral of the probability density function over all possible values the random variable can be. Or, more simply, the area under the probability density function.\n$$ E\\{x(t)\\} = \\int_{-\\infty}^{\\infty}{x f_{X}(x)} dx $$\nIn our digital signal example, it’s pretty simple to calculate this expected value since we only have two discrete values the random variable can be: 0 and 1. And each has a 50 % probability, giving\n$$ \\text{mean} = 0 \\times 0.5 + 1 \\times 0.5 = 0.5 \\text{ V} $$\nBuilding on this idea, we might decide to put some other quantity in this expectation operator. For example,\n$$ E\\{x(t) x(t + \\tau) \\} $$\nwhere \\( \\tau \\) here is acting as a time offset. Now we know that since this is a stationary random process, the probabilty density function is time independant, so the only variable in this new function is \\( \\tau \\).\nLet’s name this new function the correlation function, for reasons we should see soon.\n$$ R_{xx}(\\tau) = E\\{x(t) x(t + \\tau) \\} $$\nCalculating some examples should help see what this correlation function tells us. Let’s start with the simplest case where \\( \\tau = 0 \\). That means we will be calculating the expected value\n$$ E\\{x(t) x(t) \\} $$\nwhere again, since this our probability density function is independant of time, means we can choose any time to evaluate this at. Referring back to Figure 3 let’s look at the purple line where \\( t = 7 \\).\nThe value of the random variable \\( x(t = 7) \\) will be 1 half the time and 0 half the time. So when multiplying it with itself and taking the expected value we will get:\n$$ R_{xx}(\\tau = 0) = (1 \\times 1) \\times 0.5 + (0 \\times 0) \\times 0.5 = 1 \\text{ V}^{2} $$\nThings get more interesting when \\( \\tau \\) gets larger - specifically larger than the bit length \\( T \\). Let’s use \\( x(t = 7) \\) again but this time have \\( \\tau = 1.8 \\), which is shown on Figure 3 as the orange line.\nIn this case, \\( x(7) \\) will be 1 half the time and 0 half the time as before, but now, \\( x(7 + 1.8) \\) will also be 1 half the time and 0 half the time, independant of what \\( x(7) \\) is. This gives us four possible combinations:\n$$ R_{xx}(\\tau = 1.8) = (1 \\times 1 ) + (1 \\times 0) \\times 0.5 + (0 \\times 1) \\times 0.5 + (0 \\times 0) \\times 0.5 $$\n$$ R_{xx}(\\tau = 0) = 0.25 \\text{ V}^{2} $$\nAs a final case, let’s look at a value of \\( \\tau \\) that is less than the bit period \\( T \\). For example, \\( \\tau = 0.5 \\). As before, \\( x(7) \\) will be 1 half the time and 0 half the time, but calculating the probability that \\( x(7 + 0.5) \\) will be 1 or 0 is slightly harder due to the offset we have included. Notice in Figure 3 that if \\( x(7) = 0 \\), it’s somewhat more likely that \\( x(7 + 0.5) \\) will also be a 0 than a 1, because they might fall in the same bit (and vice versa if \\( x(7) = 1 \\)). In fact, the smaller \\( \\tau \\) is, the higher the probability that the two random variables will have the same value, affecting our correlation function.\nWe can plot the full correlation function over a range of \\( \\tau \\) values as shown in Figure 4.\nFigure 4: Plotting the correlation function of the digital signal stationary random process example.\nFigure 4 code\r1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 ''' Plotting the correlation function of the digital signal stationary random process example. Created by: simmeon Last Modified: 2025-01-25 License: MIT ''' import matplotlib.pyplot as plt import numpy as np plt.style.use('https://github.com/dhaitz/matplotlib-stylesheets/raw/master/pitayasmoothie-dark.mplstyle') # Array of tau values to calculate the correlation function over tau = np.linspace(-5, 5, 500) # Correlation function # NOTE: this is not calculated properly in any way, # it is quick and dirty but gives the correct result def Rxx(tau_array): Rxx = [] for tau in tau_array: if abs(tau) \u003c 1: Rxx.append(((1 - abs(tau)) / 1) * 0.25 + 0.25) else: Rxx.append(0.25) return Rxx R = Rxx(tau) plt.plot(tau, R) plt.title('Correlation Function of Digital Signal', fontsize=20) plt.xlabel(r'$\\tau$', fontsize=20) plt.ylabel(r'$R_{xx}(\\tau)$', fontsize=20) plt.yticks([0, 0.25, 0.5, 0.75, 1.0]) plt.xticks(np.arange(-5, 6, 1)) plt.ylim((0, 1)) plt.show() As we can see, as \\( \\tau \\) gets smaller than the bit length \\( T \\), the correlation function increases linearly. When \\( \\tau \\) is bigger than \\( T \\), the two random variables are completely independant and have the value of \\( 0.25 \\text{ V}^{2} \\) as we calculated. And when \\( \\tau = 0 \\) we get \\( 0.5 \\text{ V}^{2} \\) – also what we calculated.\nYou may be starting to realise now why this is called the correlation function. It is telling us something about whether we can predict the future value of a function based on its current value. In other words, it tells us whether there is any correlation between the current value and the future value.\nWhen \\( \\tau = 0 \\), that future value is always the current value, so we have the highest correlation. As \\( \\tau \\) gets bigger, we get less sure about whether we are still on the same bit and therefore if we are able to predict the future value. Finally, after \\( \\tau \u003e 1\\), we are definitely on a different bit and so have no way of predicting the future value from our current value.\nNote, however, that when \\( \\tau \u003e 1 \\) the correlation function is not 0. This is somewhat deceptive as it suggests there is some correlation even though we know this isn’t true. Because of this, a better name for this function may be the ‘average shared directional power’ [1]. This won’t be very relevant for how we will be using this function, but it’s worth keeping in mind.\nTo summarise, we now have a tool called the correlation function defined as\n$$ R_{xx}(\\tau) = E\\{x(t) x(t + \\tau) \\} $$\nWhen we use the same stationary random process, we call this the auto-correlation function. We can also use two different stationary random processes:\n$$ R_{xy}(\\tau) = E\\{x(t) y(t + \\tau) \\} $$\nwhich we would call the cross-correlation function. This can be interpreted as telling us about whether a future value of \\( y(t) \\) can be predicted from the current value of \\( x(t) \\).\nWhile it may not seem like it yet, these correlation functions form the basis for the method we will use to derive our frequency responses. But we need to derive one more function before we get there.\nSpectral Density Functions We know that, to get our frequency responses, we will have to go into the frequency domain at some point. Spectral density functions will give our statistical methods derived so far a link between the time and frequency domains.\nSpectra Via Correlation Function Transforming our newly-derived correlation function into the frequency domain seems like a good place to start. Luckily, this is pretty straightforward with the Fourier transform.\n$$ S_{xx}(f) = \\int_{-\\infty}^{\\infty}{R_{xx}(\\tau) e^{-j 2 \\pi f \\tau}} d\\tau $$\nAs this integral is from \\( -\\infty \\) to \\( \\infty \\), we will get both positive and negative frequencies as a result. \\( S_{xx}(f) \\) is the two-sided power spectral density function. It related to power since the correlation function has an \\( x^{2} \\) relationship, often proportional to power. It is a spectral density because the Fourier transform gives us power per Hertz, ie. a density over frequency.\nWhen dealing with real systems, we don’t really care about negative frequencies. And since the Fourier transform is symmetric, we don’t get any additional information from those negative frequencies. So we can instead use the one-sided spectral density function \\( G_{xx}(f) \\) where we cut off the negative frequencies and shift all that power into the positive frequencies:\n$$ G_{xx}(f) = 2 S_{xx}(f) \\text{ , where } f \u003e 0 $$\nMuch like with the correlation function, if we use the same two stationary random processes, we will call this the autospectral density function.\nWe can also define the cross spectral density function with two different processes:\n$$ G_{xy}(f) = 2 S_{xy}(f) \\text{ , where } f \u003e 0 $$\nFigure 5 shows both the one-sided and two-sided power spectral density functions for our digital signal example.\nFigure 5: Plotting the spectral density function of the digital signal stationary random process example.\nFigure 5 code\r1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 ''' Plotting the spectral density function of the digital signal stationary random process example. Created by: simmeon Last Modified: 2025-01-25 License: MIT ''' import matplotlib.pyplot as plt import numpy as np from scipy.fft import fft, fftfreq from scipy.signal import zoom_fft plt.style.use('https://github.com/dhaitz/matplotlib-stylesheets/raw/master/pitayasmoothie-dark.mplstyle') # Array of tau values to calculate the correlation function over n = 5000 T = 5 tau = np.linspace(-T/2, T/2, n) # Correlation function # NOTE: this is not calculated properly in any way, # it is quick and dirty but gives the correct result def Rxx(tau_array): Rxx = [] for tau in tau_array: if abs(tau) \u003c 1: Rxx.append(((1 - abs(tau)) / 1) * 0.25 + 0.25) else: Rxx.append(0.25) return Rxx R = Rxx(tau) # Fourier transform of correlation function using a fancy chirp-z tranform method # for better frequency resolution G = zoom_fft(R, [0, 1], m=len(R)//2, fs=n/(2*T)) G = abs(G) / n # Frequencies corresponding to Fourier transform data f = np.linspace(0, 1, len(R)//2) # zoom_fft gives only positive freqs, aka. one-sided # since Fourier is symmetric, we can flip it for negative freqs S_negative = np.flip(G) f_negative = - np.flip(f) G = G.tolist() S_negative = S_negative.tolist() f = f.tolist() f_negative = f_negative.tolist() # Adding positive and negative freqs and halving amplitude gives full two-sided spectral density S = S_negative + G f = f_negative + f S = np.array(S) S = S / 2 # Plotting fig = plt.figure() ax1 = fig.add_subplot(2,1,1) ax2 = fig.add_subplot(2,1,2) ax1.plot(f[n//2:], S[n//2:], color='white') ax1.plot(f[0:n//2], S[0:n//2], color='white') ax2.plot(f[n//2:], G, color='white') ax1.set_title('Two and One-sided Spectral Density Functions of Digital Signal', fontsize=20) ax2.set_xlabel('f', fontsize=20) ax1.set_ylabel(r'$S_{xx}(\\tau)$', fontsize=20) ax2.set_ylabel(r'$G_{xx}(\\tau)$', fontsize=20) ax1.set_xlim((-1, 1)) ax2.set_xlim((-1, 1)) ax1.set_ylim((0, 0.3)) ax2.set_ylim((0, 0.3)) ax1.set_xticks(np.arange(-1, 1.1, 0.1)) ax2.set_xticks(np.arange(-1, 1.1, 0.1)) plt.show() This is the final tool we need to calculate our frequency responses. However, calculating these spectral density functions is quite a process. In particular, calculating or estimating the probability density functions of our stationary random processes can be very tricky.\nIt would be nice if there was a simpler way to get these spectral densities…\nSpectra Via Finite Fourier Transform Luckily, there is an easier way! Unfortunately, it’s a bit messy to derive.\nWe will start by showing the result we want to end up with, then showing that it gives the same result as the previous method.\nWe will be deriving the cross-spectra of two different stationary random processes, \\( x(t) \\) and \\( y(t) \\). And what we are going to guess is that for a finite time interval \\( 0 \u003c t \u003c T \\), our cross-spectra will be\n$$ S_{xy}(f, T, k) = \\frac{1}{T} X_{k}^{*}(f, T) Y_{k}(f, T) $$\nwhere \\( X_{k}^{*}(f, T) \\) is the complex conjugate of the finite Fourier transform of the stationary random process \\( x_{k}(t) \\) over the interval \\( [0, T] \\). Similarly, \\( Y_{k}(f, T) \\) is the finite Fourier transform of \\( y_{k}(t) \\) over the same interval.\n$$ X_{k}(f, T) = \\int_{0}^{T}{x_{k}(t) e^{-j 2 \\pi f t}}dt $$\n$$ Y_{k}(f, T) = \\int_{0}^{T}{y_{k}(t) e^{-j 2 \\pi f t}}dt $$\nThis would be a very useful result that would make calculating spectral density functions much easier. What we need to prove is that our guess will lead to the same definition as earlier:\n$$ S_{xy}(f) = \\int_{-\\infty}^{\\infty}{R_{xy}(\\tau) e^{-j 2 \\pi f \\tau}} d\\tau $$\nFirst of all, our guess is currently dependant on a finite value of \\( T \\) and is defined in terms of the stationary random processes. To turn in into something more useful, we need to take the limit as \\( T \\to \\infty \\) and then also take the expected value of the stationary random processes.\n$$ S_{xy}(f) = \\lim_{T \\to \\infty} E\\{ S_{xy}(f, T, k) \\} $$\nLet’s now write out fully what \\( S_{xy}(f, T, k) \\) looks like.\n$$ S_{xy}(f, T, k) = \\frac{1}{T} \\int_{0}^{T}{x_{k}(\\alpha) e^{-j 2 \\pi f \\alpha}}d\\alpha \\int_{0}^{T}{y_{k}(\\beta) e^{-j 2 \\pi f \\beta}}d\\beta $$\nInstead of \\( t \\) we will use \\( \\alpha \\) and \\( \\beta \\) to help make it clear which variables are in which integral.\n$$ S_{xy}(f, T, k) = \\frac{1}{T} \\int_{0}^{T} \\int_{0}^{T} x_{k}(\\alpha) y_{k}(\\beta) e^{-j 2 \\pi f ( \\beta -\\alpha)} d\\alpha d\\beta $$\nWe also know that, if we want this to match our earlier derivation, this integral will have to be over \\( \\tau \\). So we will change our integration variables to be \\( \\alpha \\) and \\( \\tau \\), where \\( \\tau = \\beta - \\alpha \\). This should make sense as \\( \\tau \\) was the difference between the two times we would look at when creating the correlation function.\nAs for how this will change our integral, we can show that\n$$ \\int_{0}^{T} \\int_{0}^{T} d\\alpha d\\beta = \\int_{-T}^{0} \\int_{-\\tau}^{T} d\\alpha d\\tau + \\int_{0}^{T} \\int_{0}^{T - \\tau} d\\alpha d\\tau $$\nwhere both sides give the value \\( T^{2} \\).\nPutting our full integral back in gives us\n$$ S_{xy}(f, T, k) = \\int_{-T}^{0} \\bigg[ \\frac{1}{T} \\int_{-\\tau}^{T} x_{k}(\\alpha) y_{k}(\\alpha + \\tau) d\\alpha \\bigg] e^{-j 2 \\pi f \\tau} d\\tau + \\int_{0}^{T} \\bigg[ \\frac{1}{T} \\int_{0}^{T - \\tau} x_{k}(\\alpha) y_{k}(\\alpha + \\tau) d\\alpha \\bigg] e^{-j 2 \\pi f \\tau} d\\tau $$\nWe can then take the expected value of both sides, remembering that \\( R_{xy}(\\tau) = E\\{ x_{k}(\\alpha) y_{k}(\\alpha + \\tau) \\} \\).\n$$ E\\{ S_{xy}(f, T, k) \\} = \\int_{-T}^{0} \\bigg[ \\frac{1}{T} \\int_{-\\tau}^{T} R_{xy}(\\tau) d\\alpha \\bigg] e^{-j 2 \\pi f \\tau} d\\tau + \\int_{0}^{T} \\bigg[ \\frac{1}{T} \\int_{0}^{T - \\tau} R_{xy}(\\tau) d\\alpha \\bigg] e^{-j 2 \\pi f \\tau} d\\tau $$\nIf we look at the integrals inside the square brackets, we can actually evaluate these fairly easily.\n$$ \\begin{aligned} \\frac{1}{T} \\int_{-\\tau}^{T} R_{xy}(\\tau) d\\alpha \u0026= R_{xy}(\\tau) \\frac{1}{T} \\int_{-\\tau}^{T} d\\alpha \\\\ \u0026= R_{xy}(\\tau) \\frac{1}{T} \\big[ \\alpha \\big]_{\\alpha = -\\tau}^{T} \\\\ \u0026= R_{xy}(\\tau) \\frac{1}{T} (T + \\tau) \\\\ \u0026= R_{xy}(\\tau) (1 + \\frac{\\tau}{T}) \\end{aligned} $$\n$$ \\begin{aligned} \\frac{1}{T} \\int_{0}^{T - \\tau} R_{xy}(\\tau) d\\alpha \u0026= R_{xy}(\\tau) \\frac{1}{T} \\int_{0}^{T - \\tau} d\\alpha \\\\ \u0026= R_{xy}(\\tau) \\frac{1}{T} \\big[ \\alpha \\big]_{\\alpha = 0}^{T - \\tau} \\\\ \u0026= R_{xy}(\\tau) \\frac{1}{T} (T - \\tau) \\\\ \u0026= R_{xy}(\\tau) (1 - \\frac{\\tau}{T}) \\end{aligned} $$\nSubbing these back into our equation gives\n$$ E\\{ S_{xy}(f, T, k) \\} = \\int_{-T}^{0} R_{xy}(\\tau) (1 + \\frac{\\tau}{T}) e^{-j 2 \\pi f \\tau} d\\tau + \\int_{0}^{T} R_{xy}(\\tau) (1 - \\frac{\\tau}{T}) e^{-j 2 \\pi f \\tau} d\\tau $$\nLet’s now take the limit as \\( T \\to \\infty \\) of both sides. This will make \\( \\frac{\\tau}{T} \\to 0 \\).\n$$ \\lim_{T \\to \\infty} E\\{ S_{xy}(f, T, k) \\} = \\int_{-\\infty}^{0} R_{xy}(\\tau) e^{-j 2 \\pi f \\tau} d\\tau + \\int_{0}^{\\infty} R_{xy}(\\tau) e^{-j 2 \\pi f \\tau} d\\tau $$\nWe now have the same integrand in both integrals and the upper bound of the first is the same as the lower bound of the second (they are both 0). This means we can combine them into a single integral giving\n$$ \\lim_{T \\to \\infty} E\\{ S_{xy}(f, T, k) \\} = \\int_{-\\infty}^{\\infty} R_{xy}(\\tau) e^{-j 2 \\pi f \\tau} d\\tau = S_{xy}(f) $$\nGreat! This shows that our guess from the beginning actually does give the same spectral density function. To be clear, we can write\n$$ S_{xy}(f) = \\lim_{T \\to \\infty} \\frac{1}{T} E\\{ X_{k}^{*}(f, T) Y_{k}(f, T) \\} $$\nand similarly with our one-sided spectral density functions\n$$ G_{xy}(f) = \\lim_{T \\to \\infty} \\frac{2}{T} E\\{ X_{k}^{*}(f, T) Y_{k}(f, T) \\} \\text{ , where } f \u003e 0 $$\nIn practice, \\( T \\) will always be a finite value, and we will not be able to calculate the true expected value of the Fourier transforms of our stationary random processes. Instead, we will roughly estimate that the expected value will be what our single sample functions give us: \\( x(t) \\) and \\( y(t) \\). This gives us a rough spectral density estimate of\n$$ \\hat{G}_{xy}(f) = \\frac{2}{T} \\big[ X^{*}(f) Y(f) \\big] $$\nwhere \\( X(f) \\) and \\( Y(f) \\) are the finite Fourier transforms of our single sample functions.\nWe can see what this estimate looks like in Figure 6 and Figure 7.\nFigure 6: Plotting the spectral density and estimated spectral density functions of the digital signal stationary random process example.\nFigure 7: Plotting the spectral density and 100 estimated spectral density functions.\nFigure 6 \u0026 7 code\r1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 ''' Estimated spectral density function of the digital signal from direct finite Fourier transforms. Created by: simmeon Last Modified: 2025-01-26 License: MIT ''' import matplotlib.pyplot as plt import numpy as np from scipy.signal import zoom_fft plt.style.use('https://github.com/dhaitz/matplotlib-stylesheets/raw/master/pitayasmoothie-dark.mplstyle') # Same proper G from last example # Array of tau values to calculate the correlation function over n = 5000 T = 5 tau = np.linspace(-T/2, T/2, n) # Correlation function # NOTE: this is not calculated properly in any way, # it is quick and dirty but gives the correct result def Rxx(tau_array): Rxx = [] for tau in tau_array: if abs(tau) \u003c 1: Rxx.append(((1 - abs(tau)) / 1) * 0.25 + 0.25) else: Rxx.append(0.25) return Rxx R = Rxx(tau) # Fourier transform of correlation function using a fancy chirp-z tranform method # for better frequency resolution G = zoom_fft(R, [0, 1], m=len(R)//2, fs=n/(2*T)) G_actual = abs(G) / len(R) f_actual = np.linspace(0, 1, len(R)//2) # --------------------------------------------------------------------- # G_array = [] for i in range(100): num_bits = 10 # Calculate random series of bits bits = np.random.randint(0, 2, num_bits) N = 100 # Number of sample points per bit bit_length = 1 # seconds # Make length of each bit 1 s T = num_bits * bit_length t = np.linspace(0, T, num_bits * N) # sample function x = [] # Make sample function have N points per bit and add offsets for bit in bits: x = x + [bit] * N # Fourier transform sample function X = zoom_fft(x, [0, 1], m=len(x)//2, fs=N) X = abs(X) / len(x) * 2 # Calculate estimated spectral density G = 2 / T * (np.conjugate(X) * X) G_array.append(G) # Frequencies corresponding to Fourier transform data f = np.linspace(0, 1, len(x)//2) for G in G_array: plt.plot(f, G, alpha=0.05) plt.plot(f_actual, G_actual, label='Actual') plt.title('100 Estimates of Spectral Density Function', fontsize=20) plt.xlim((0, 1)) plt.xticks(np.arange(0, 1.1, 0.1)) plt.ylabel(r'$G_{xx}(f)$', fontsize=20) plt.xlabel('f', fontsize=20) plt.legend(fontsize=20) plt.show() Now that we have a good way of calculating these spectra, let’s find out how they will be useful for finding frequency responses…\nSingle Input Single Output (SISO) Frequency Responses Starting from the familiar convolution integral that describes a SISO system,\n$$ y(t) = \\int_{0}^{\\infty} h(\\alpha) x(t - \\alpha) d\\alpha $$\nwe can also describe the system at time \\( t + \\tau \\) as\n$$ y(t + \\tau) = \\int_{0}^{\\infty} h(\\alpha) x(t + \\tau - \\alpha) d\\alpha $$\nMultiplying both sides by \\( x(t) \\) gives\n$$ x(t) y(t + \\tau) = \\int_{0}^{\\infty} h(\\alpha) x(t) x(t + \\tau - \\alpha) d\\alpha $$\nRemember that we are going to assume our input \\( x(t) \\) and output \\( y(t) \\) are both stationary random processes, so we can take the expected value of both sides to get\n$$ E\\{x(t) y(t + \\tau)\\} = \\int_{0}^{\\infty} h(\\alpha) E\\{x(t) x(t + \\tau - \\alpha)\\} d\\alpha $$\n$$ R_{xy}(\\tau) = \\int_{0}^{\\infty} h(\\alpha) R_{xx}(\\tau - \\alpha) d\\alpha $$\nNow we have the same form of convolution integral just in terms of correlation functions instead of our stationary random processes. So we can transform this into the Fourier domain to change the convolution integral into a multiplication.\n$$ S_{xy}(f) = H(f) S_{xx}(f) $$\nFinally getting the relationship between our statistical methods and the frequency response we’ve been building up.\n$$ H(f) = \\frac{S_{xy}(f)}{S_{xx}(f)} = \\frac{G_{xy}(f)}{G_{xx}(f)} $$\nMultiple Input Single Output (MISO) Frequency Responses Theory on Partially Correlated Inputs To be able to understand what happens when we have correlated inputs, we first need to think about what a system with correlated inputs would look like. To do this, we will make use of some helpful system diagrams.\nFigure 8 shows a diagram of a single-input, single-output system as a reference.\nFigure 8: Single input single output system diagram.\nIf we have two inputs \\( x_{1} \\) and \\( x_{2} \\), and if they are correlated, we could think of \\( x_{2} \\) as being made up of an uncorrelated part, \\( x_{2_{UC}} \\) and a part that is correlated with \\( x_{1} \\) which we can call \\( x_{2_{C}} \\).\nWe can think of this correlated part as being a linear transformation of \\( x_{1} \\), which we can represent by a transfer function \\( L_{12}(f) \\). Note that often these correlation effects will be non-linear so we will use the notation \\( L_{12}(f) \\) to represent the transfer function with the optimum linear effects between the input \\( x_{1} \\) and output \\( x_{2_{C}} \\).\nFigure 9 shows this idea in a diagram.\nFigure 8: Two-input single-output system diagram with partially correlated inputs.\nNow, if we wanted to find the frequency response between \\( x_{1} \\) and \\( y \\), we would think to calculate\n$$ \\frac{Y(f)}{X_{1}(f)} $$\nbut because \\( x_{2} \\) also effects the output \\( y \\) through \\( H_{2y} \\) and because \\( x_{1} \\) is correlated with \\( x_{2} \\) through \\( L_{12} \\), doing this will actually calculate\n$$ \\frac{Y(f)}{X_{1}(f)} = H_{1y}(f) + H_{2y}(f) L_{12}(f) $$\nwhich does not just give us \\( H_{1y}(f) \\) as we want. Because \\( x_{1} \\) gets to \\( y \\) through multiple paths (not just through \\( H_{1y} \\)), we have to account for this ’error’ to isolate the actual frequency response we care about: \\( H_{1y}(f) \\).\nConditioned Frequency Responses So how do we use the tools we developed to correct, or condition, these frequency responses to actually give us what we want? Since we’re now defining our frequency response in terms of spectral functions, for our two input example we know we will need \\( G_{1y} \\) and \\( G_{11} \\). Let’s recall the definition of our spectral density function using \\( G_{1y} \\) (ignoring the limit as \\( T \\to \\infty \\)).\n$$ G_{1y}(f) = \\frac{2}{T} E\\{ X^{*}_{1}(f) Y(f) \\} $$\nwhere we just showed that\n$$ Y(f) = H_{1y}(f) X_{1}(f) + H_{2y}(f) L_{12}(f) X_{1}(f) $$\nSubstituing this into our spectral density function gives\n$$ \\begin{aligned} G_{1y}(f) \u0026= \\frac{2}{T} E\\{ X^{*}_{1}(f) \\big[ H_{1y}(f) X_{1}(f) + H_{2y}(f) L_{12}(f) X_{1}(f) \\big] \\} \\\\ \u0026= \\frac{2}{T} E\\{ H_{1y}(f) X^*_{1}(f) X_{1}(f) + H_{2y}(f) L_{12}(f) X^*_{1}(f) X_{1}(f) \\} \\\\ \u0026= \\frac{2}{T} \\bigg( H_{1y}(f) \\frac{T}{2} G_{11}(f) + H_{2y}(f) L_{12}(f) \\frac{T}{2} G_{11}(f) \\bigg) \\\\ \u0026= H_{1y}(f) G_{11}(f) + H_{2y}(f) L_{12}(f) G_{11}(f) \\end{aligned} $$\nFrom this, we can see that\n$$ \\frac{G_{1y}(f)}{G_{11}(f)} = H_{1y}(f) + H_{2y}(f) L_{12}(f) $$\nand therefore\n$$ H_{1y}(f) = \\frac{G_{1y}(f)}{G_{11}(f)} - H_{2y}(f) L_{12}(f) $$\nas we saw before.\nThe important equation here is\n$$ G_{1y}(f) = H_{1y}(f) G_{11}(f) + H_{2y}(f) L_{12}(f) G_{11}(f) $$\nNotice that\n$$ L_{12}(f) G_{11}(f) = G_{12}(f) $$\nso we can write\n$$ G_{1y}(f) = H_{1y}(f) G_{11}(f) + H_{2y}(f) G_{12}(f) $$\nA very similar method could be used for \\( G_{2y}(f) \\).\n$$ G_{2y}(f) = H_{1y}(f) G_{21}(f) + H_{2y}(f) G_{22}(f) $$\nThis gives us two equations with only two unknows: \\( H_{1y}(f) \\) and \\( H_{2y}(f) \\), the two frequency responses of the system. We can calculate all the spectral functions here.\nWe can solve these simultaneously in matrix form for each discrete frequency \\( f_{i} \\).\n$$ \\begin{bmatrix} G_{11}(f_{i}) \u0026 G_{12}(f_{i}) \\\\ G_{21}(f_{i}) \u0026 G_{22}(f_{i}) \\end{bmatrix} \\begin{bmatrix} H_{1y}(f_{i}) \\\\ H_{2y}(f_{i}) \\end{bmatrix} = \\begin{bmatrix} G_{1y}(f_{i}) \\\\ G_{2y}(f_{i}) \\end{bmatrix} $$\n$$ \\begin{bmatrix} H_{1y}(f_{i}) \\\\ H_{2y}(f_{i}) \\end{bmatrix} = \\begin{bmatrix} G_{11}(f_{i}) \u0026 G_{12}(f_{i}) \\\\ G_{21}(f_{i}) \u0026 G_{22}(f_{i}) \\end{bmatrix} ^{-1} \\begin{bmatrix} G_{1y}(f_{i}) \\\\ G_{2y}(f_{i}) \\end{bmatrix} $$\nThis finally gives us our conditioned frequency responses. We can also extend this idea to an arbitrary number of inputs.\nAn example, revisited Let’s go back to the example we started this all with and take a closer look at how the system was defined.\nTO BE CONTINUED\nReferences [1] What is Autocorrelation?\n[2] Bendat, Julius S., and Allan G. Piersol. Random data: analysis and measurement procedures. John Wiley \u0026 Sons, 2011.\n[3] Tischler, Mark B., and Robert K. Remple. Aircraft and rotorcraft system identification. Reston, VA: American Institute of Aeronautics and Astronautics, 2012.\n[4] Otnes, Robert K. “Digital time series analysis.” John Wiley \u0026 Sons, (1972).\n",
  "wordCount" : "7477",
  "inLanguage": "en",
  "image":"http://localhost:1313/blog/%3Cimage%20path/url%3E","datePublished": "2025-02-04T19:36:10+13:00",
  "dateModified": "2025-02-04T19:36:10+13:00",
  "author":{
    "@type": "Person",
    "name": "simmeon"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/blog/posts/conditionedfrequencyresponses/conditionedfrequencyresponses/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "simmeon's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/blog/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/blog/" accesskey="h" title="simmeon&#39;s blog (Alt + H)">simmeon&#39;s blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/blog/archives/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/blog/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/blog/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/blog/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/blog/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Conditioned Frequency Responses
    </h1>
    <div class="post-description">
      Understanding how to find frequency responses when there are multiple correlated inputs present.
    </div>
    <div class="post-meta"><span title='2025-02-04 19:36:10 +1300 NZDT'>February 4, 2025</span>&nbsp;·&nbsp;36 min&nbsp;·&nbsp;7477 words&nbsp;·&nbsp;simmeon&nbsp;|&nbsp;<a href="https://github.com/simmeon/blog/tree/main/content//posts/conditionedFrequencyResponses/conditionedFrequencyResponses.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#an-example" aria-label="An example">An example</a></li>
                <li>
                    <a href="#what-is-this-all-about" aria-label="What is this all about?">What is this all about?</a></li>
                <li>
                    <a href="#stationary-random-processes" aria-label="Stationary Random Processes">Stationary Random Processes</a><ul>
                        
                <li>
                    <a href="#basics" aria-label="Basics">Basics</a></li>
                <li>
                    <a href="#correlation-functions" aria-label="Correlation Functions">Correlation Functions</a></li>
                <li>
                    <a href="#spectral-density-functions" aria-label="Spectral Density Functions">Spectral Density Functions</a><ul>
                        
                <li>
                    <a href="#spectra-via-correlation-function" aria-label="Spectra Via Correlation Function">Spectra Via Correlation Function</a></li>
                <li>
                    <a href="#spectra-via-finite-fourier-transform" aria-label="Spectra Via Finite Fourier Transform">Spectra Via Finite Fourier Transform</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#single-input-single-output-siso-frequency-responses" aria-label="Single Input Single Output (SISO) Frequency Responses">Single Input Single Output (SISO) Frequency Responses</a></li>
                <li>
                    <a href="#multiple-input-single-output-miso-frequency-responses" aria-label="Multiple Input Single Output (MISO) Frequency Responses">Multiple Input Single Output (MISO) Frequency Responses</a><ul>
                        
                <li>
                    <a href="#theory-on-partially-correlated-inputs" aria-label="Theory on Partially Correlated Inputs">Theory on Partially Correlated Inputs</a></li>
                <li>
                    <a href="#conditioned-frequency-responses" aria-label="Conditioned Frequency Responses">Conditioned Frequency Responses</a></li></ul>
                </li>
                <li>
                    <a href="#an-example-revisited" aria-label="An example, revisited">An example, revisited</a></li>
                <li>
                    <a href="#references" aria-label="References">References</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><!-- Import KaTeX -->


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>


<h2 id="an-example">An example<a hidden class="anchor" aria-hidden="true" href="#an-example">#</a></h2>
<p>Imagine we&rsquo;re looking into a system that has the following sort of form</p>
<p>$$
\ddot{y}(t) + c \dot{y}(t) + k y(t) = x_{1}(t) + x_{2}(t)
$$</p>
<p>where \( y \) is our output and there are two inputs, \( x_{1} \) and \( x_{2} \). For the purpose
of this example, we don&rsquo;t know exactly what \( c \) and \( k \) are - the specific system we have is
a bit of a mystery. What we can do, however, is measure the inputs we put into the system and
then measure the output we get.</p>
<p>This is useful because we know that the frequency response of a system is</p>
<p>$$
H(f) = \frac{Y(f)}{X(f)}
$$</p>
<p>for some output \( y \) and input \( x \). We know that we can get lots of useful information
about how our system behaves from the frequency response - things like where natural frequencies are
and whether the system will be stable at certain frequencies.</p>
<p>So let&rsquo;s Fourier transform our input and output data and have a look at the frequency responses
we get. And just to compare, let&rsquo;s also plot the analytical frequency responses just to show that we
did it right.</p>
<figure class="align-center ">
    <img loading="lazy" src="../img/intro-example.png#center"
         alt="Figure 1: A simple two-input, one-output linear system to introduce the problems that arise with partially correlated inputs."/> <figcaption>
            <p><strong>Figure 1</strong>: A simple two-input, one-output linear system to introduce the problems that arise with partially correlated inputs.</p>
        </figcaption>
</figure>



<p><details >
  <summary markdown="span">Figure 1 code</summary>
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">A simple two-input (partically correlated), one-output linear system to introduce 
</span></span></span><span class="line"><span class="cl"><span class="s1">the problems that arise with partially correlated inputs.
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">Last Modified: 2025-02-04
</span></span></span><span class="line"><span class="cl"><span class="s1">License: MIT
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">chirp</span><span class="p">,</span> <span class="n">zoom_fft</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;https://github.com/dhaitz/matplotlib-stylesheets/raw/master/pitayasmoothie-dark.mplstyle&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ------------------------------------------------------------------------------</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Define and simulate system</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># System coefficienets (this is secret don&#39;t look...)</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="mf">0.5</span>
</span></span><span class="line"><span class="cl"><span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># ~ 158</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Simulation properties</span>
</span></span><span class="line"><span class="cl"><span class="n">T</span> <span class="o">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl"><span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
</span></span><span class="line"><span class="cl"><span class="n">N</span> <span class="o">=</span> <span class="n">T</span> <span class="o">*</span> <span class="n">fs</span>
</span></span><span class="line"><span class="cl"><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Define input x1: freq sweep</span>
</span></span><span class="line"><span class="cl"><span class="n">fmin</span> <span class="o">=</span> <span class="mf">0.1</span>
</span></span><span class="line"><span class="cl"><span class="n">fmax</span> <span class="o">=</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="n">x1</span> <span class="o">=</span> <span class="n">chirp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">fmax</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Define input x2: partially correlated</span>
</span></span><span class="line"><span class="cl"><span class="n">x2_uc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">x2</span> <span class="o">=</span> <span class="n">d</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">x2_uc</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Define state derivative</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">dydt</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">u1</span> <span class="o">=</span> <span class="n">x1</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">u2</span> <span class="o">=</span> <span class="n">x2</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span> <span class="n">k</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">c</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="n">u1</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">u2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="c1"># Simulate system</span>
</span></span><span class="line"><span class="cl"><span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">dydt</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ------------------------------------------------------------------------------</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Frequency Responses</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Analytical frequency response</span>
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fmin</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fmax</span><span class="p">),</span> <span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="mf">1.0</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">f</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">H1y</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">s</span> <span class="o">+</span> <span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">H2y</span> <span class="o">=</span> <span class="n">b</span> <span class="o">/</span> <span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">s</span> <span class="o">+</span> <span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Estimated response</span>
</span></span><span class="line"><span class="cl"><span class="n">Y</span> <span class="o">=</span> <span class="n">zoom_fft</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">[</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">],</span> <span class="n">m</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">X1</span> <span class="o">=</span> <span class="n">zoom_fft</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="p">[</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">],</span> <span class="n">m</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">X2</span> <span class="o">=</span> <span class="n">zoom_fft</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="p">[</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">],</span> <span class="n">m</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">H1y_est</span> <span class="o">=</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">X1</span>
</span></span><span class="line"><span class="cl"><span class="n">H2y_est</span> <span class="o">=</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">X2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">f_est</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ------------------------------------------------------------------------------</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Plotting</span>
</span></span><span class="line"><span class="cl"><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Y / X_</span><span class="si">{1}</span><span class="s1">$ Magnitude&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">H1y</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Analytical&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">f_est</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">H1y_est</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Estimated&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Y / X_</span><span class="si">{1}</span><span class="s1">$ Phase&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">H1y</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Analytical&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">f_est</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">H1y_est</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Estimated&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Y / X_</span><span class="si">{2}</span><span class="s1">$ Magnitude&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax3</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">H2y</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Analytical&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax3</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">f_est</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">H2y_est</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Estimated&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$Y / X_</span><span class="si">{2}</span><span class="s1">$ Phase&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax4</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">H2y</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Analytical&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax4</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">f_est</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">H2y_est</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Estimated&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude [dB]&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase [deg]&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">ax4</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div>
</details></p>

<p>Woah okay that&rsquo;s not great&hellip;</p>
<p>The noise is expected due to what our inputs are and how the Fourier transform and frequency response is computed, but the magnitude of both our calculated frequency responses is definitely much higher than it should be.</p>
<p>What&rsquo;s going on here? As a hint of where this is going, it has to do with our two inputs being partially
correlated. In this case that means that \( x_{2} \) is partially made up of \( x_{1} \).</p>
<h2 id="what-is-this-all-about">What is this all about?<a hidden class="anchor" aria-hidden="true" href="#what-is-this-all-about">#</a></h2>
<p>A frequency response gives information about how an output of a system will react to a sinusoidal input at different frequencies. They are very useful in analysing the stability and behaviour of systems. They are also central to frequency-domain system identification methods, which is what we will be interested in using them for.</p>
<p>As we already said, for some system input \( x(t) \) and output \( y(t) \), the frequency response is</p>
<p>$$
H(f) = \frac{Y(f)}{X(f)}
$$</p>
<p><strong>But this is not always entirely true</strong>. In systems where there are <em>multiple partially correlated inputs</em> and those inputs all affect the output, we have to be more careful about how we calculate these frequency responses. In other words, we have to <em>condition</em> the frequency responses to remove the effects that
come from this correlation.</p>
<p>Throughout this post, we will develop a very useful way to calculate frequency responses (especially for system identification) using spectral density functions. Then, we will apply this method in single-input single-output (SISO) systems. We will build up some theory on how to describe these correlation effects in multiple-input single-output (MISO) systems and see why the above equation for frequency responses is lacking. Finally, we will discuss how to change our method to <em>condition</em> these frequency responses so
they are correct.</p>
<h2 id="stationary-random-processes">Stationary Random Processes<a hidden class="anchor" aria-hidden="true" href="#stationary-random-processes">#</a></h2>
<p>We are mostly going to be interested in frequency responses for the purpose of system identification. That means we will have real measured data for \( x(t) \) and \( y(t) \). If we then want to find the frequency response, you may first think to just follow the earlier equation and Fourier transform both of these.</p>
<p>And that would work! But it&rsquo;s important to remember that we&rsquo;re working with real-world measured data here, and real-world data always has a lot of noise, disturbances, and other issues that make our clean theoretical equations less useful. Take the following example in <strong>Figure 1</strong>:</p>
<figure class="align-center ">
    <img loading="lazy" src="../img/freq-response-straight-fourier.png#center"
         alt="Figure 1: Seeing how noisy data can affect direct calculation of the frequency response from Fourier transforms."/> <figcaption>
            <p><strong>Figure 1</strong>: Seeing how noisy data can affect direct calculation of the frequency response from Fourier transforms.</p>
        </figcaption>
</figure>



<p><details >
  <summary markdown="span">Figure 1 code</summary>
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">Seeing how noisy data can affect direct calculation of the frequency
</span></span></span><span class="line"><span class="cl"><span class="s1">response from Fourier transforms.
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">Created by: simmeon
</span></span></span><span class="line"><span class="cl"><span class="s1">Last Modified: 2025-01-25
</span></span></span><span class="line"><span class="cl"><span class="s1">License: MIT
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">scipy.fft</span> <span class="kn">import</span> <span class="n">rfft</span><span class="p">,</span> <span class="n">rfftfreq</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;https://github.com/dhaitz/matplotlib-stylesheets/raw/master/pitayasmoothie-dark.mplstyle&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Let&#39;s set up a simple spring, mass, damper system to mess around with.</span>
</span></span><span class="line"><span class="cl"><span class="n">fn</span> <span class="o">=</span> <span class="mi">1</span>              <span class="c1"># natural frequency of system [Hz]</span>
</span></span><span class="line"><span class="cl"><span class="n">zeta</span> <span class="o">=</span> <span class="mf">0.05</span>          <span class="c1"># system damping ratio</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">wn</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">fn</span>    <span class="c1"># natural freq [rad/s]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># We can find the analytical transfer function to get the true frequency response</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">H_func</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="mf">1.0</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">f</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">wn</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">zeta</span> <span class="o">*</span> <span class="n">wn</span> <span class="o">*</span> <span class="n">s</span> <span class="o">+</span> <span class="n">wn</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fmin</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># min frequency in response</span>
</span></span><span class="line"><span class="cl"><span class="n">fmax</span> <span class="o">=</span> <span class="mi">10</span>   <span class="c1"># max frequency in response</span>
</span></span><span class="line"><span class="cl"><span class="n">f_analytical</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fmin</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fmax</span><span class="p">),</span> <span class="mi">500</span><span class="p">)</span> <span class="c1"># array of freqs to calculate response for</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">H_analytical</span> <span class="o">=</span> <span class="n">H_func</span><span class="p">(</span><span class="n">f_analytical</span><span class="p">)</span>                     <span class="c1"># Frequency response</span>
</span></span><span class="line"><span class="cl"><span class="n">mag_analytical</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">H_analytical</span><span class="p">))</span>       <span class="c1"># Magnitude of response (in dB)</span>
</span></span><span class="line"><span class="cl"><span class="n">phase_analytical</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">H_analytical</span><span class="p">))</span>   <span class="c1"># Phase of response (in deg)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Now let&#39;s create some noisy input and output data to simulate measurements</span>
</span></span><span class="line"><span class="cl"><span class="c1"># To do this we will solve the system with a frequency sweep over the range of interest (0.1 - 10 Hz)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">T</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># period to simulate system over [s]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Define our input function, a frequency sweep</span>
</span></span><span class="line"><span class="cl"><span class="c1"># NOTE: to get a correct frequency response over all frequencies of interest, the input must</span>
</span></span><span class="line"><span class="cl"><span class="c1"># necessarily contaion information on all the frequencies you are interested in. </span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">u_func</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span> <span class="o">=</span> <span class="n">t</span> <span class="o">/</span> <span class="n">T</span> <span class="o">*</span> <span class="n">fmax</span> <span class="o">*</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">f</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Define the derivative function of the system (state space derivative)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">dxdt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">u</span> <span class="o">=</span> <span class="n">u_func</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span> <span class="n">wn</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">zeta</span> <span class="o">*</span> <span class="n">wn</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">wn</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Solve system</span>
</span></span><span class="line"><span class="cl"><span class="n">N</span> <span class="o">=</span> <span class="mi">5000</span>                   <span class="c1"># number of sample points</span>
</span></span><span class="line"><span class="cl"><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>    <span class="c1"># time array</span>
</span></span><span class="line"><span class="cl"><span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>       <span class="c1"># initial state conditions</span>
</span></span><span class="line"><span class="cl"><span class="n">sol</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">dxdt</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>   <span class="c1"># pull out position from state as our output</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="n">u_func</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>   <span class="c1"># get array of inputs for use later</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Now we will add some output noise to simulate noisy measurements</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Then, we can fourier transform our input and output to calculate the freqency response</span>
</span></span><span class="line"><span class="cl"><span class="n">Y</span> <span class="o">=</span> <span class="n">rfft</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">X</span> <span class="o">=</span> <span class="n">rfft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">f_estimated</span> <span class="o">=</span> <span class="n">rfftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">T</span> <span class="o">/</span> <span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">H_estimated</span> <span class="o">=</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">X</span>                                   <span class="c1"># Estimated freq response from noisy data</span>
</span></span><span class="line"><span class="cl"><span class="n">mag_estimated</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">H_estimated</span><span class="p">))</span>       <span class="c1"># Magnitude of response (in dB)</span>
</span></span><span class="line"><span class="cl"><span class="n">phase_estimated</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">H_estimated</span><span class="p">))</span>   <span class="c1"># Phase of response (in deg)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Plotting</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Subplot 1: Time domain response</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&#34;System Response (y) over Time&#34;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&#34;Time (s)&#34;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&#34;Output (y)&#34;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Subplot 2: Bode magnitude plot</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">f_estimated</span><span class="p">,</span> <span class="n">mag_estimated</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&#34;Estimated&#34;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">f_analytical</span><span class="p">,</span> <span class="n">mag_analytical</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&#34;Analytical&#34;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&#34;Bode Magnitude Plot&#34;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&#34;Magnitude (dB)&#34;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Subplot 3: Bode phase plot</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">f_estimated</span><span class="p">,</span> <span class="n">phase_estimated</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&#34;Estimated&#34;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">f_analytical</span><span class="p">,</span> <span class="n">phase_analytical</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&#34;Analytical&#34;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&#34;Bode Phase Plot&#34;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&#34;Phase (Degrees)&#34;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&#34;Frequency (Hz)&#34;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div>
</details></p>

<p>While the frequency response estimate is still pretty good where it matters, you can see how the noise starts to introduce larger errors as the frequency increases. What would be nice is a way of somehow modelling this noise and creating methods that are able to account for noise and let us minimise the impact of it.</p>
<p>To do this we will turn to some statistical methods and see where they can take us&hellip;</p>
<h3 id="basics">Basics<a hidden class="anchor" aria-hidden="true" href="#basics">#</a></h3>
<p>First, let&rsquo;s look at the concept of a stationary random process. A random process meaning some function whose value at any given time is random. Each time index can be described by a random variable. This is good as our measurement noise can be modelled by these random variables. The random process is <em>stationary</em> if the probability density function of the random variable at any time is the same.</p>
<p>Let&rsquo;s look at an example to help. In <strong>Figure 2</strong>, we are using random normal noise as our random variable at each time \( t_{i} \) to generate a &lsquo;<em>sample function</em>&rsquo;, \( x_{1}(t) \), of the random process.</p>
<p>If we do this multiple times to create lots of sample functions \( x_{k}(t), k = 1, 2, &hellip; \), we can then estimate the probability density function of the random variable at a particular time \( t_{i} \). For example, if we focus on time \( t = 0 \), we could estimate the probability density function \( f_{X}(x) \) by counting how many sample functions had a value \( x_{k}(0) \) within certain ranges. Eg. how many had a value between 0 and 0.5? Between 0.5 and 1? Between -2 and -1.5?</p>
<p>Basically we are creating a histogram of all the \( x_{k}(0) \) values. We can then do the same thing for every time index \( t_{i} \).</p>
<figure class="align-center ">
    <img loading="lazy" src="../img/stationary-random-process.png#center"
         alt="Figure 2: Exploring what a stationary random process is and some useful features of it."/> <figcaption>
            <p><strong>Figure 2</strong>: Exploring what a stationary random process is and some useful features of it.</p>
        </figcaption>
</figure>



<p><details >
  <summary markdown="span">Figure 2 code</summary>
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">Exploring what a stationary random process is and some useful features of it.
</span></span></span><span class="line"><span class="cl"><span class="s1">Created by: simmeon
</span></span></span><span class="line"><span class="cl"><span class="s1">Last Modified: 2025-01-25
</span></span></span><span class="line"><span class="cl"><span class="s1">License: MIT
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="kn">import</span> <span class="n">histogram</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;https://github.com/dhaitz/matplotlib-stylesheets/raw/master/pitayasmoothie-dark.mplstyle&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># We will want to store each &#39;sample function&#39; in an array</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">N</span> <span class="o">=</span> <span class="mi">50</span> <span class="c1"># sample length</span>
</span></span><span class="line"><span class="cl"><span class="n">T</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># time period sample is over</span>
</span></span><span class="line"><span class="cl"><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">num_samples</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># number of sample functions to run</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_samples</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># The stationary random process we will use is random normal noise</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># We can then estimate the probability density function at a particular time (t)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># by counting how many of the sample functions have values within a particular </span>
</span></span><span class="line"><span class="cl"><span class="c1"># range at that time.</span>
</span></span><span class="line"><span class="cl"><span class="n">ti_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">pdfs</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="n">num_bins</span> <span class="o">=</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl"><span class="n">pdf_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">num_bins</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_samples</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">ti_data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">pdfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">histogram</span><span class="p">(</span><span class="n">ti_data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">num_bins</span><span class="p">)</span> <span class="o">/</span> <span class="n">num_samples</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Plotting</span>
</span></span><span class="line"><span class="cl"><span class="n">fig</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&#34;One Sample Function&#34;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&#34;t&#34;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&#34;x(t)&#34;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;Probability Density Function for $t = 0$&#34;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;$x(t = 0$)&#34;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;$f_</span><span class="si">{X}</span><span class="s2">(x)$&#34;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pdf_vals</span><span class="p">,</span> <span class="n">pdfs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&#34;All Sample Functions&#34;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&#34;t&#34;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&#34;x(t)&#34;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_samples</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;Probability Density Functions for each $t_</span><span class="si">{i}</span><span class="s2">$&#34;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;$x(t_</span><span class="si">{i}</span><span class="s2">$)&#34;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;$f_</span><span class="si">{X}</span><span class="s2">(x)$&#34;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pdf_vals</span><span class="p">,</span> <span class="n">pdfs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pdf_vals</span><span class="p">,</span> <span class="n">pdfs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax4</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div>
</details></p>

<p>Something that stands out is how the probability density function for every time index looks about the same. And, in fact, if we had worked it out analytically instead of estimating it, we would see that it is exactly the same probability density function for every time. This is the key feature that makes our random process a <em>stationary</em> random process.</p>
<p>This is really useful because it allows us to model a function over time in a way that doesn&rsquo;t care about what specific time we are looking at. All the information about what value the function may be at any given time is encapsulated by a single probability density function that&rsquo;s independant of time.</p>
<p>But why is this going to be useful? What can we do with this? And how does it relate to calculating frequency responses?</p>
<p>You might be starting to think that if we assume our input and output records are stationary random processes, we might be able to do some fancy statistical manipulation with them. Which is exactly what we will try do next&hellip;</p>
<h3 id="correlation-functions">Correlation Functions<a hidden class="anchor" aria-hidden="true" href="#correlation-functions">#</a></h3>
<p>What kinds of things can we do with these stationary random processes? Let&rsquo;s use a different, simpler example to help.</p>
<p>Take the following digital signal which can either be 1 V or 0 V to represent either a 1 or 0 bit. Each bit has a length of \( T \) and each sample function may be offset from others. We will also assume it is random whether we see a 1 V or 0 V at any time. <strong>Figure 3</strong> has some example sample functions of this signal.</p>
<figure class="align-center ">
    <img loading="lazy" src="../img/digital-signal-srp.png#center"
         alt="Figure 3: Some sample functions of our digital signal stationary random process."/> <figcaption>
            <p><strong>Figure 3</strong>: Some sample functions of our digital signal stationary random process.</p>
        </figcaption>
</figure>



<p><details >
  <summary markdown="span">Figure 3 code</summary>
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">Some sample functions of our digital signal stationary random process.
</span></span></span><span class="line"><span class="cl"><span class="s1">Created by: simmeon
</span></span></span><span class="line"><span class="cl"><span class="s1">Last Modified: 2025-01-25
</span></span></span><span class="line"><span class="cl"><span class="s1">License: MIT
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;https://github.com/dhaitz/matplotlib-stylesheets/raw/master/pitayasmoothie-dark.mplstyle&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">num_bits</span> <span class="o">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Calculate random series of bits</span>
</span></span><span class="line"><span class="cl"><span class="n">bits1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">num_bits</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">bits2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">num_bits</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">bits3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">num_bits</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">N</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># Number of sample points per bit</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Make length of each bit 1 s</span>
</span></span><span class="line"><span class="cl"><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_bits</span><span class="p">,</span> <span class="n">num_bits</span> <span class="o">*</span> <span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># sample functions</span>
</span></span><span class="line"><span class="cl"><span class="n">x1</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="n">x2</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="n">x3</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Make sample function have N points per bit and add offsets</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">bits1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">x1</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="p">[</span><span class="n">bit</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">bits2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">x2</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">+</span> <span class="p">[</span><span class="n">bit</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span>
</span></span><span class="line"><span class="cl"><span class="n">x2</span> <span class="o">=</span> <span class="n">x2</span><span class="p">[</span><span class="mi">35</span><span class="p">:]</span> <span class="o">+</span> <span class="n">x2</span><span class="p">[:</span><span class="mi">35</span><span class="p">]</span> <span class="c1"># offset</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">bits3</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">x3</span> <span class="o">=</span> <span class="n">x3</span> <span class="o">+</span> <span class="p">[</span><span class="n">bit</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span>
</span></span><span class="line"><span class="cl"><span class="n">x3</span> <span class="o">=</span> <span class="n">x3</span><span class="p">[</span><span class="mi">60</span><span class="p">:]</span> <span class="o">+</span> <span class="n">x3</span><span class="p">[:</span><span class="mi">60</span><span class="p">]</span> <span class="c1"># offset</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Plotting</span>
</span></span><span class="line"><span class="cl"><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Digital Signal Sample Functions&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">ax3</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Voltage (V)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div>
</details></p>

<p>Hopefully you can convince yourself that the probability density function of this random process will be the same at any time: in half the samples we will get a 1 and the other half we will get a 0. So this is another example of a stationary random process.</p>
<p>One fairly simple thing we could look at is the mean (or expected value) of this stationary random process. In more formal terms, we would use the expectation operator:</p>
<p>$$
\text{mean} = E\{x_{k}(t)\}
$$</p>
<p>Since the probability density function is the same for all time, we can also think of the expected value as the integral of the probability density function over all possible values the random variable can be. Or, more simply, the area under the probability density function.</p>
<p>$$
E\{x(t)\} = \int_{-\infty}^{\infty}{x f_{X}(x)} dx
$$</p>
<p>In our digital signal example, it&rsquo;s pretty simple to calculate this expected value since we only have two discrete values the random variable can be: 0 and 1. And each has a 50 % probability, giving</p>
<p>$$
\text{mean} = 0 \times 0.5 + 1 \times 0.5 = 0.5 \text{ V}
$$</p>
<p>Building on this idea, we might decide to put some other quantity in this expectation operator. For example,</p>
<p>$$
E\{x(t) x(t + \tau) \}
$$</p>
<p>where \( \tau \) here is acting as a time offset. Now we know that since this is a stationary random process, the probabilty density function is time independant, so the only variable in this new function is \( \tau \).</p>
<p>Let&rsquo;s name this new function the <em>correlation function</em>, for reasons we should see soon.</p>
<p>$$
R_{xx}(\tau) = E\{x(t) x(t + \tau) \}
$$</p>
<p>Calculating some examples should help see what this correlation function tells us. Let&rsquo;s start with the simplest case where \( \tau = 0 \). That means we will be calculating the expected value</p>
<p>$$
E\{x(t) x(t) \}
$$</p>
<p>where again, since this our probability density function is independant of time, means we can choose any time to evaluate this at. Referring back to <strong>Figure 3</strong> let&rsquo;s look at the purple line where \( t = 7 \).</p>
<p>The value of the random variable \( x(t = 7) \) will be 1 half the time and 0 half the time. So when multiplying it with itself and taking the expected value we will get:</p>
<p>$$
R_{xx}(\tau = 0) = (1 \times 1) \times 0.5 + (0 \times 0) \times 0.5 = 1 \text{ V}^{2}
$$</p>
<p>Things get more interesting when \( \tau \) gets larger - specifically larger than the bit length \( T \). Let&rsquo;s use \( x(t = 7) \) again but this time have \( \tau = 1.8 \), which is shown on <strong>Figure 3</strong> as the orange line.</p>
<p>In this case, \( x(7) \) will be 1 half the time and 0 half the time as before, but now, \( x(7 + 1.8) \) will also be 1 half the time and 0 half the time, independant of what \( x(7) \) is. This gives us four possible combinations:</p>
<p>$$
R_{xx}(\tau = 1.8) = (1 \times 1 ) + (1 \times 0) \times 0.5 + (0 \times 1) \times 0.5 + (0 \times 0) \times 0.5
$$</p>
<p>$$
R_{xx}(\tau = 0) = 0.25 \text{ V}^{2}
$$</p>
<p>As a final case, let&rsquo;s look at a value of \( \tau \) that is less than the bit period \( T \). For example, \( \tau = 0.5 \). As before, \( x(7) \) will be 1 half the time and 0 half the time, but calculating the probability that \( x(7 + 0.5) \) will be 1 or 0 is slightly harder due to the offset we have included. Notice in <strong>Figure 3</strong> that if \( x(7) = 0 \), it&rsquo;s somewhat more likely that \( x(7 + 0.5) \) will also be a 0 than a 1, because they might fall in the same bit (and vice versa if \( x(7) = 1 \)). In fact, the smaller \( \tau \) is, the higher the probability that the two random variables will have the same value, affecting our correlation function.</p>
<p>We can plot the full correlation function over a range of \( \tau \) values as shown in <strong>Figure 4</strong>.</p>
<figure class="align-center ">
    <img loading="lazy" src="../img/digital-signal-correlation-function.png#center"
         alt="Figure 4: Plotting the correlation function of the digital signal stationary random process example."/> <figcaption>
            <p><strong>Figure 4</strong>: Plotting the correlation function of the digital signal stationary random process example.</p>
        </figcaption>
</figure>



<p><details >
  <summary markdown="span">Figure 4 code</summary>
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">Plotting the correlation function of the digital signal stationary random process example.
</span></span></span><span class="line"><span class="cl"><span class="s1">Created by: simmeon
</span></span></span><span class="line"><span class="cl"><span class="s1">Last Modified: 2025-01-25
</span></span></span><span class="line"><span class="cl"><span class="s1">License: MIT
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;https://github.com/dhaitz/matplotlib-stylesheets/raw/master/pitayasmoothie-dark.mplstyle&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Array of tau values to calculate the correlation function over</span>
</span></span><span class="line"><span class="cl"><span class="n">tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Correlation function</span>
</span></span><span class="line"><span class="cl"><span class="c1"># NOTE: this is not calculated properly in any way,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># it is quick and dirty but gives the correct result</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">Rxx</span><span class="p">(</span><span class="n">tau_array</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">Rxx</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">tau</span> <span class="ow">in</span> <span class="n">tau_array</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">Rxx</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">tau</span><span class="p">))</span> <span class="o">/</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.25</span> <span class="o">+</span> <span class="mf">0.25</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">Rxx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">Rxx</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">R</span> <span class="o">=</span> <span class="n">Rxx</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Correlation Function of Digital Signal&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\tau$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$R_</span><span class="si">{xx}</span><span class="s1">(\tau)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div>
</details></p>

<p>As we can see, as \( \tau \) gets smaller than the bit length \( T \), the correlation function increases linearly. When \( \tau \) is bigger than \( T \), the two random variables are completely independant and have the value of \( 0.25 \text{ V}^{2} \) as we calculated. And when \( \tau = 0 \) we get \( 0.5 \text{ V}^{2} \) &ndash; also what we calculated.</p>
<p>You may be starting to realise now why this is called the correlation function. It is telling us something about whether we can predict the future value of a function based on its current value. In other words, it tells us whether there is any <em>correlation</em> between the current value and the future value.</p>
<p>When \( \tau = 0 \), that future value is always the current value, so we have the highest correlation. As \( \tau \) gets bigger, we get less sure about whether we are still on the same bit and therefore if we are able to predict the future value. Finally, after \( \tau &gt; 1\), we are definitely on a different bit and so have no way of predicting the future value from our current value.</p>
<p>Note, however, that when \( \tau &gt; 1 \) the correlation function is <em>not</em> 0. This is somewhat deceptive as it suggests there is some correlation even though we know this isn&rsquo;t true. Because of this, a better name for this function may be the &lsquo;average shared directional power&rsquo; [1]. This won&rsquo;t be very relevant for how we will be using this function, but it&rsquo;s worth keeping in mind.</p>
<p>To summarise, we now have a tool called the correlation function defined as</p>
<p>$$
R_{xx}(\tau) = E\{x(t) x(t + \tau) \}
$$</p>
<p>When we use the same stationary random process, we call this the auto-correlation function. We can also use two different stationary random processes:</p>
<p>$$
R_{xy}(\tau) = E\{x(t) y(t + \tau) \}
$$</p>
<p>which we would call the cross-correlation function. This can be interpreted as telling us about whether a future value of \( y(t) \) can be predicted from the current value of \( x(t) \).</p>
<p>While it may not seem like it yet, these correlation functions form the basis for the method we will use to derive our frequency responses. But we need to derive one more function before we get there.</p>
<h3 id="spectral-density-functions">Spectral Density Functions<a hidden class="anchor" aria-hidden="true" href="#spectral-density-functions">#</a></h3>
<p>We know that, to get our frequency responses, we will have to go into the frequency domain at some point. Spectral density functions will give our statistical methods derived so far a link between the time and frequency domains.</p>
<h4 id="spectra-via-correlation-function">Spectra Via Correlation Function<a hidden class="anchor" aria-hidden="true" href="#spectra-via-correlation-function">#</a></h4>
<p>Transforming our newly-derived correlation function into the frequency domain seems like a good place to start. Luckily, this is pretty straightforward with the Fourier transform.</p>
<p>$$
S_{xx}(f) = \int_{-\infty}^{\infty}{R_{xx}(\tau) e^{-j 2 \pi f \tau}} d\tau
$$</p>
<p>As this integral is from \( -\infty \) to \( \infty \), we will get both positive and negative frequencies as a result. \( S_{xx}(f) \) is the <em>two-sided power spectral density</em> function. It related to <em>power</em> since the correlation function has an \( x^{2} \) relationship, often proportional to power. It is a <em>spectral density</em> because the Fourier transform gives us power per Hertz, ie. a density over frequency.</p>
<p>When dealing with real systems, we don&rsquo;t really care about negative frequencies. And since the Fourier transform is symmetric, we don&rsquo;t get any additional information from those negative frequencies. So we can instead use the <em>one-sided</em> spectral density function \( G_{xx}(f) \) where we cut off the negative frequencies and shift all that power into the positive frequencies:</p>
<p>$$
G_{xx}(f) = 2 S_{xx}(f) \text{ , where } f &gt; 0
$$</p>
<p>Much like with the correlation function, if we use the same two stationary random processes, we will call this the autospectral density function.</p>
<p>We can also define the cross spectral density function with two different processes:</p>
<p>$$
G_{xy}(f) = 2 S_{xy}(f) \text{ , where } f &gt; 0
$$</p>
<p><strong>Figure 5</strong> shows both the one-sided and two-sided power spectral density functions for our digital signal example.</p>
<figure class="align-center ">
    <img loading="lazy" src="../img/digital-signal-spectral-density.png#center"
         alt="Figure 5: Plotting the spectral density function of the digital signal stationary random process example."/> <figcaption>
            <p><strong>Figure 5</strong>: Plotting the spectral density function of the digital signal stationary random process example.</p>
        </figcaption>
</figure>



<p><details >
  <summary markdown="span">Figure 5 code</summary>
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">Plotting the spectral density function of the digital signal stationary random process example.
</span></span></span><span class="line"><span class="cl"><span class="s1">Created by: simmeon
</span></span></span><span class="line"><span class="cl"><span class="s1">Last Modified: 2025-01-25
</span></span></span><span class="line"><span class="cl"><span class="s1">License: MIT
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">scipy.fft</span> <span class="kn">import</span> <span class="n">fft</span><span class="p">,</span> <span class="n">fftfreq</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">zoom_fft</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;https://github.com/dhaitz/matplotlib-stylesheets/raw/master/pitayasmoothie-dark.mplstyle&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Array of tau values to calculate the correlation function over</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">5000</span>
</span></span><span class="line"><span class="cl"><span class="n">T</span> <span class="o">=</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">T</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Correlation function</span>
</span></span><span class="line"><span class="cl"><span class="c1"># NOTE: this is not calculated properly in any way,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># it is quick and dirty but gives the correct result</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">Rxx</span><span class="p">(</span><span class="n">tau_array</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">Rxx</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">tau</span> <span class="ow">in</span> <span class="n">tau_array</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">Rxx</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">tau</span><span class="p">))</span> <span class="o">/</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.25</span> <span class="o">+</span> <span class="mf">0.25</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">Rxx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">Rxx</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">R</span> <span class="o">=</span> <span class="n">Rxx</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Fourier transform of correlation function using a fancy chirp-z tranform method</span>
</span></span><span class="line"><span class="cl"><span class="c1"># for better frequency resolution</span>
</span></span><span class="line"><span class="cl"><span class="n">G</span> <span class="o">=</span> <span class="n">zoom_fft</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">m</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">n</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">G</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Frequencies corresponding to Fourier transform data</span>
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># zoom_fft gives only positive freqs, aka. one-sided</span>
</span></span><span class="line"><span class="cl"><span class="c1"># since Fourier is symmetric, we can flip it for negative freqs</span>
</span></span><span class="line"><span class="cl"><span class="n">S_negative</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">f_negative</span> <span class="o">=</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">G</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">S_negative</span> <span class="o">=</span> <span class="n">S_negative</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">f_negative</span> <span class="o">=</span> <span class="n">f_negative</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Adding positive and negative freqs and halving amplitude gives full two-sided spectral density</span>
</span></span><span class="line"><span class="cl"><span class="n">S</span> <span class="o">=</span> <span class="n">S_negative</span> <span class="o">+</span> <span class="n">G</span>
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="n">f_negative</span> <span class="o">+</span> <span class="n">f</span>
</span></span><span class="line"><span class="cl"><span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">S</span> <span class="o">=</span> <span class="n">S</span> <span class="o">/</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Plotting</span>
</span></span><span class="line"><span class="cl"><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">S</span><span class="p">[</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">G</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Two and One-sided Spectral Density Functions of Digital Signal&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$S_</span><span class="si">{xx}</span><span class="s1">(\tau)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$G_</span><span class="si">{xx}</span><span class="s1">(\tau)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div>
</details></p>

<p>This is the final tool we need to calculate our frequency responses. However, calculating these spectral density functions is quite a process. In particular, calculating or estimating the probability density functions of our stationary random processes can be very tricky.</p>
<p>It would be nice if there was a simpler way to get these spectral densities&hellip;</p>
<h4 id="spectra-via-finite-fourier-transform">Spectra Via Finite Fourier Transform<a hidden class="anchor" aria-hidden="true" href="#spectra-via-finite-fourier-transform">#</a></h4>
<p>Luckily, there is an easier way! Unfortunately, it&rsquo;s a bit messy to derive.</p>
<p>We will start by showing the result we want to end up with, then showing that it gives the same result as the previous method.</p>
<p>We will be deriving the cross-spectra of two different stationary random processes, \( x(t) \) and \( y(t) \). And what we are going to guess is that for a <em>finite</em> time interval \( 0 &lt; t &lt; T \), our cross-spectra will be</p>
<p>$$
S_{xy}(f, T, k) = \frac{1}{T} X_{k}^{*}(f, T) Y_{k}(f, T)
$$</p>
<p>where \( X_{k}^{*}(f, T) \) is the complex conjugate of the finite Fourier transform of the stationary  random process \( x_{k}(t) \) over the interval \( [0, T] \). Similarly, \( Y_{k}(f, T) \) is the finite Fourier transform of \( y_{k}(t) \) over the same interval.</p>
<p>$$
X_{k}(f, T) = \int_{0}^{T}{x_{k}(t) e^{-j 2 \pi f t}}dt
$$</p>
<p>$$
Y_{k}(f, T) = \int_{0}^{T}{y_{k}(t) e^{-j 2 \pi f t}}dt
$$</p>
<p>This would be a very useful result that would make calculating spectral density functions much easier. What we need to prove is that our guess will lead to the same definition as earlier:</p>
<p>$$
S_{xy}(f) = \int_{-\infty}^{\infty}{R_{xy}(\tau) e^{-j 2 \pi f \tau}} d\tau
$$</p>
<p>First of all, our guess is currently dependant on a finite value of \( T \) and is defined in terms of the stationary random processes. To turn in into something more useful, we need to take the limit as \( T \to \infty \) and then also take the expected value of the stationary random processes.</p>
<p>$$
S_{xy}(f) = \lim_{T \to \infty} E\{ S_{xy}(f, T, k) \}
$$</p>
<p>Let&rsquo;s now write out fully what \( S_{xy}(f, T, k) \) looks like.</p>
<p>$$
S_{xy}(f, T, k) = \frac{1}{T} \int_{0}^{T}{x_{k}(\alpha) e^{-j 2 \pi f \alpha}}d\alpha \int_{0}^{T}{y_{k}(\beta) e^{-j 2 \pi f \beta}}d\beta
$$</p>
<p>Instead of \( t \) we will use \( \alpha \) and \( \beta \) to help make it clear which variables are in which integral.</p>
<p>$$
S_{xy}(f, T, k) = \frac{1}{T} \int_{0}^{T} \int_{0}^{T} x_{k}(\alpha) y_{k}(\beta) e^{-j 2 \pi f ( \beta -\alpha)} d\alpha d\beta
$$</p>
<p>We also know that, if we want this to match our earlier derivation, this integral will have to be over \( \tau \). So we will change our integration variables to be \( \alpha \) and \( \tau \), where \( \tau = \beta - \alpha \). This should make sense as \( \tau \) was the difference between the two times we would look at when creating the correlation function.</p>
<p>As for how this will change our integral, we can show that</p>
<p>$$
\int_{0}^{T} \int_{0}^{T} d\alpha d\beta = \int_{-T}^{0} \int_{-\tau}^{T} d\alpha d\tau + \int_{0}^{T} \int_{0}^{T - \tau} d\alpha d\tau
$$</p>
<p>where both sides give the value \( T^{2} \).</p>
<p>Putting our full integral back in gives us</p>
<p>$$
S_{xy}(f, T, k) = \int_{-T}^{0} \bigg[ \frac{1}{T} \int_{-\tau}^{T} x_{k}(\alpha) y_{k}(\alpha + \tau) d\alpha \bigg] e^{-j 2 \pi f \tau} d\tau
+ \int_{0}^{T} \bigg[ \frac{1}{T} \int_{0}^{T - \tau} x_{k}(\alpha) y_{k}(\alpha + \tau) d\alpha \bigg] e^{-j 2 \pi f \tau} d\tau
$$</p>
<p>We can then take the expected value of both sides, remembering that \( R_{xy}(\tau) = E\{ x_{k}(\alpha) y_{k}(\alpha + \tau) \} \).</p>
<p>$$
E\{ S_{xy}(f, T, k) \} = \int_{-T}^{0} \bigg[ \frac{1}{T} \int_{-\tau}^{T} R_{xy}(\tau) d\alpha \bigg] e^{-j 2 \pi f \tau} d\tau
+ \int_{0}^{T} \bigg[ \frac{1}{T} \int_{0}^{T - \tau} R_{xy}(\tau) d\alpha \bigg] e^{-j 2 \pi f \tau} d\tau
$$</p>
<p>If we look at the integrals inside the square brackets, we can actually evaluate these fairly easily.</p>
<p>$$
\begin{aligned}
\frac{1}{T} \int_{-\tau}^{T} R_{xy}(\tau) d\alpha &amp;= R_{xy}(\tau) \frac{1}{T} \int_{-\tau}^{T} d\alpha \\
&amp;= R_{xy}(\tau) \frac{1}{T} \big[ \alpha \big]_{\alpha = -\tau}^{T}
\\
&amp;= R_{xy}(\tau) \frac{1}{T} (T + \tau)
\\
&amp;= R_{xy}(\tau) (1 + \frac{\tau}{T})
\end{aligned}
$$</p>
<p>$$
\begin{aligned}
\frac{1}{T} \int_{0}^{T - \tau} R_{xy}(\tau) d\alpha &amp;= R_{xy}(\tau) \frac{1}{T} \int_{0}^{T - \tau} d\alpha \\
&amp;= R_{xy}(\tau) \frac{1}{T} \big[ \alpha \big]_{\alpha = 0}^{T - \tau}
\\
&amp;= R_{xy}(\tau) \frac{1}{T} (T - \tau)
\\
&amp;= R_{xy}(\tau) (1 - \frac{\tau}{T})
\end{aligned}
$$</p>
<p>Subbing these back into our equation gives</p>
<p>$$
E\{ S_{xy}(f, T, k) \} = \int_{-T}^{0} R_{xy}(\tau) (1 + \frac{\tau}{T}) e^{-j 2 \pi f \tau} d\tau
+ \int_{0}^{T} R_{xy}(\tau) (1 - \frac{\tau}{T}) e^{-j 2 \pi f \tau} d\tau
$$</p>
<p>Let&rsquo;s now take the limit as \( T \to \infty \) of both sides. This will make \( \frac{\tau}{T} \to 0 \).</p>
<p>$$
\lim_{T \to \infty} E\{ S_{xy}(f, T, k) \} = \int_{-\infty}^{0} R_{xy}(\tau) e^{-j 2 \pi f \tau} d\tau
+ \int_{0}^{\infty} R_{xy}(\tau) e^{-j 2 \pi f \tau} d\tau
$$</p>
<p>We now have the same integrand in both integrals and the upper bound of the first is the same as the lower bound of the second (they are both 0). This means we can combine them into a single integral giving</p>
<p>$$
\lim_{T \to \infty} E\{ S_{xy}(f, T, k) \} = \int_{-\infty}^{\infty} R_{xy}(\tau) e^{-j 2 \pi f \tau} d\tau = S_{xy}(f)
$$</p>
<p>Great! This shows that our guess from the beginning actually does give the same spectral density function. To be clear, we can write</p>
<p>$$
S_{xy}(f) = \lim_{T \to \infty} \frac{1}{T} E\{ X_{k}^{*}(f, T) Y_{k}(f, T) \}
$$</p>
<p>and similarly with our one-sided spectral density functions</p>
<p>$$
G_{xy}(f) = \lim_{T \to \infty} \frac{2}{T} E\{ X_{k}^{*}(f, T) Y_{k}(f, T) \} \text{ , where } f &gt; 0
$$</p>
<p>In practice, \( T \) will always be a finite value, and we will not be able to calculate the true expected value of the Fourier transforms of our stationary random processes. Instead, we will roughly estimate that the expected value will be what our single sample functions give us: \( x(t) \) and \( y(t) \). This gives us a rough spectral density estimate of</p>
<p>$$
\hat{G}_{xy}(f) = \frac{2}{T} \big[ X^{*}(f) Y(f) \big]
$$</p>
<p>where \( X(f) \) and \( Y(f) \) are the finite Fourier transforms of our single sample functions.</p>
<p>We can see what this estimate looks like in <strong>Figure 6</strong> and <strong>Figure 7</strong>.</p>
<figure class="align-center ">
    <img loading="lazy" src="../img/digital-signal-spectral-density-comparison.png#center"
         alt="Figure 6: Plotting the spectral density and estimated spectral density functions of the digital signal stationary random process example."/> <figcaption>
            <p><strong>Figure 6</strong>: Plotting the spectral density and estimated spectral density functions of the digital signal stationary random process example.</p>
        </figcaption>
</figure>

<figure class="align-center ">
    <img loading="lazy" src="../img/multiple-estimates-spectral-density.png#center"
         alt="Figure 7: Plotting the spectral density and 100 estimated spectral density functions."/> <figcaption>
            <p><strong>Figure 7</strong>: Plotting the spectral density and 100 estimated spectral density functions.</p>
        </figcaption>
</figure>



<p><details >
  <summary markdown="span">Figure 6 &amp; 7 code</summary>
  <div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">Estimated spectral density function of the digital signal from direct finite Fourier transforms.
</span></span></span><span class="line"><span class="cl"><span class="s1">Created by: simmeon
</span></span></span><span class="line"><span class="cl"><span class="s1">Last Modified: 2025-01-26
</span></span></span><span class="line"><span class="cl"><span class="s1">License: MIT
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">zoom_fft</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;https://github.com/dhaitz/matplotlib-stylesheets/raw/master/pitayasmoothie-dark.mplstyle&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Same proper G from last example</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Array of tau values to calculate the correlation function over</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">5000</span>
</span></span><span class="line"><span class="cl"><span class="n">T</span> <span class="o">=</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">T</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Correlation function</span>
</span></span><span class="line"><span class="cl"><span class="c1"># NOTE: this is not calculated properly in any way,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># it is quick and dirty but gives the correct result</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">Rxx</span><span class="p">(</span><span class="n">tau_array</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">Rxx</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">tau</span> <span class="ow">in</span> <span class="n">tau_array</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">Rxx</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">tau</span><span class="p">))</span> <span class="o">/</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.25</span> <span class="o">+</span> <span class="mf">0.25</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">Rxx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">Rxx</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">R</span> <span class="o">=</span> <span class="n">Rxx</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Fourier transform of correlation function using a fancy chirp-z tranform method</span>
</span></span><span class="line"><span class="cl"><span class="c1"># for better frequency resolution</span>
</span></span><span class="line"><span class="cl"><span class="n">G</span> <span class="o">=</span> <span class="n">zoom_fft</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">m</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">n</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">G_actual</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">f_actual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># --------------------------------------------------------------------- #</span>
</span></span><span class="line"><span class="cl"><span class="n">G_array</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">num_bits</span> <span class="o">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Calculate random series of bits</span>
</span></span><span class="line"><span class="cl">    <span class="n">bits</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">num_bits</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">N</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># Number of sample points per bit</span>
</span></span><span class="line"><span class="cl">    <span class="n">bit_length</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># seconds</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Make length of each bit 1 s</span>
</span></span><span class="line"><span class="cl">    <span class="n">T</span> <span class="o">=</span> <span class="n">num_bits</span> <span class="o">*</span> <span class="n">bit_length</span>
</span></span><span class="line"><span class="cl">    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">num_bits</span> <span class="o">*</span> <span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># sample function</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Make sample function have N points per bit and add offsets</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">bits</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="p">[</span><span class="n">bit</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Fourier transform sample function</span>
</span></span><span class="line"><span class="cl">    <span class="n">X</span> <span class="o">=</span> <span class="n">zoom_fft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">m</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">X</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="c1"># Calculate estimated spectral density</span>
</span></span><span class="line"><span class="cl">    <span class="n">G</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">T</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">*</span> <span class="n">X</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">G_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Frequencies corresponding to Fourier transform data</span>
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">G</span> <span class="ow">in</span> <span class="n">G_array</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f_actual</span><span class="p">,</span> <span class="n">G_actual</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;100 Estimates of Spectral Density Function&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$G_</span><span class="si">{xx}</span><span class="s1">(f)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div>
</details></p>

<p>Now that we have a good way of calculating these spectra, let&rsquo;s find out how they will be useful for finding frequency responses&hellip;</p>
<h2 id="single-input-single-output-siso-frequency-responses">Single Input Single Output (SISO) Frequency Responses<a hidden class="anchor" aria-hidden="true" href="#single-input-single-output-siso-frequency-responses">#</a></h2>
<p>Starting from the familiar convolution integral that describes a SISO system,</p>
<p>$$
y(t) = \int_{0}^{\infty} h(\alpha) x(t - \alpha) d\alpha
$$</p>
<p>we can also describe the system at time \( t + \tau \) as</p>
<p>$$
y(t + \tau) = \int_{0}^{\infty} h(\alpha) x(t + \tau - \alpha) d\alpha
$$</p>
<p>Multiplying both sides by \( x(t) \) gives</p>
<p>$$
x(t) y(t + \tau) = \int_{0}^{\infty} h(\alpha) x(t) x(t + \tau - \alpha) d\alpha
$$</p>
<p>Remember that we are going to assume our input \( x(t) \) and output \( y(t) \) are both stationary random processes, so we can take the expected value of both sides to get</p>
<p>$$
E\{x(t) y(t + \tau)\} = \int_{0}^{\infty} h(\alpha) E\{x(t) x(t + \tau - \alpha)\} d\alpha
$$</p>
<p>$$
R_{xy}(\tau) = \int_{0}^{\infty} h(\alpha) R_{xx}(\tau - \alpha) d\alpha
$$</p>
<p>Now we have the same form of convolution integral just in terms of correlation functions instead of our stationary random processes. So we can transform this into the Fourier domain to change the convolution integral into a multiplication.</p>
<p>$$
S_{xy}(f) = H(f) S_{xx}(f)
$$</p>
<p>Finally getting the relationship between our statistical methods and the frequency response we&rsquo;ve been building up.</p>
<p>$$
H(f) = \frac{S_{xy}(f)}{S_{xx}(f)} = \frac{G_{xy}(f)}{G_{xx}(f)}
$$</p>
<h2 id="multiple-input-single-output-miso-frequency-responses">Multiple Input Single Output (MISO) Frequency Responses<a hidden class="anchor" aria-hidden="true" href="#multiple-input-single-output-miso-frequency-responses">#</a></h2>
<h3 id="theory-on-partially-correlated-inputs">Theory on Partially Correlated Inputs<a hidden class="anchor" aria-hidden="true" href="#theory-on-partially-correlated-inputs">#</a></h3>
<p>To be able to understand what happens when we have correlated inputs, we first need to think about what a system with correlated inputs would look like. To do this, we will make use of some helpful system diagrams.</p>
<p><strong>Figure 8</strong> shows a diagram of a single-input, single-output system as a reference.</p>
<figure class="align-center ">
    <img loading="lazy" src="../img/siso-system-diagram.png#center"
         alt="Figure 8: Single input single output system diagram."/> <figcaption>
            <p><strong>Figure 8</strong>: Single input single output system diagram.</p>
        </figcaption>
</figure>

<p>If we have two inputs \( x_{1} \) and \( x_{2} \), and if they are correlated, we could think of \( x_{2} \) as being made up of an uncorrelated part, \( x_{2_{UC}} \) and a part that is correlated with \( x_{1} \) which we can call \( x_{2_{C}} \).</p>
<p>We can think of this correlated part as being a linear transformation of \( x_{1} \), which we can represent by a transfer function \( L_{12}(f) \). Note that often these correlation effects will be non-linear so we will use the notation \( L_{12}(f) \) to represent the transfer function with the optimum linear effects between the input \( x_{1} \) and output \( x_{2_{C}} \).</p>
<p><strong>Figure 9</strong> shows this idea in a diagram.</p>
<figure class="align-center ">
    <img loading="lazy" src="../img/miso-system-diagram.png#center"
         alt="Figure 8: Two-input single-output system diagram with partially correlated inputs."/> <figcaption>
            <p><strong>Figure 8</strong>: Two-input single-output system diagram with partially correlated inputs.</p>
        </figcaption>
</figure>

<p>Now, if we wanted to find the frequency response between \( x_{1} \) and \( y \), we would think to calculate</p>
<p>$$
\frac{Y(f)}{X_{1}(f)}
$$</p>
<p>but because \( x_{2} \) also effects the output \( y \) through \( H_{2y} \) <em>and</em> because \( x_{1} \) is correlated with \( x_{2} \) through \( L_{12} \), doing this will actually calculate</p>
<p>$$
\frac{Y(f)}{X_{1}(f)} = H_{1y}(f) + H_{2y}(f) L_{12}(f)
$$</p>
<p>which does <em>not</em> just give us \( H_{1y}(f) \) as we want. Because \( x_{1} \) gets to \( y \) through multiple paths (not just through \( H_{1y} \)), we have to account for this &rsquo;error&rsquo; to isolate the actual frequency response we care about: \( H_{1y}(f) \).</p>
<h3 id="conditioned-frequency-responses">Conditioned Frequency Responses<a hidden class="anchor" aria-hidden="true" href="#conditioned-frequency-responses">#</a></h3>
<p>So how do we use the tools we developed to correct, or <em>condition</em>, these frequency responses to actually give us what we want? Since we&rsquo;re now defining our frequency response in terms of spectral functions, for our two input example we know we will need \( G_{1y} \) and \( G_{11} \). Let&rsquo;s recall the definition of our spectral density function using \( G_{1y} \) (ignoring the limit as \( T \to \infty \)).</p>
<p>$$
G_{1y}(f) = \frac{2}{T} E\{ X^{*}_{1}(f) Y(f) \}
$$</p>
<p>where we just showed that</p>
<p>$$
Y(f) = H_{1y}(f) X_{1}(f) + H_{2y}(f) L_{12}(f) X_{1}(f)
$$</p>
<p>Substituing this into our spectral density function gives</p>
<p>$$
\begin{aligned}
G_{1y}(f) &amp;= \frac{2}{T} E\{ X^{*}_{1}(f) \big[ H_{1y}(f) X_{1}(f) + H_{2y}(f) L_{12}(f) X_{1}(f) \big] \}
\\
&amp;= \frac{2}{T} E\{ H_{1y}(f) X^*_{1}(f) X_{1}(f) + H_{2y}(f) L_{12}(f) X^*_{1}(f) X_{1}(f) \}
\\
&amp;= \frac{2}{T} \bigg( H_{1y}(f) \frac{T}{2} G_{11}(f) + H_{2y}(f) L_{12}(f) \frac{T}{2} G_{11}(f) \bigg)
\\
&amp;= H_{1y}(f) G_{11}(f) + H_{2y}(f) L_{12}(f) G_{11}(f)
\end{aligned}
$$</p>
<p>From this, we can see that</p>
<p>$$
\frac{G_{1y}(f)}{G_{11}(f)} = H_{1y}(f) + H_{2y}(f) L_{12}(f)
$$</p>
<p>and therefore</p>
<p>$$
H_{1y}(f) = \frac{G_{1y}(f)}{G_{11}(f)} - H_{2y}(f) L_{12}(f)
$$</p>
<p>as we saw before.</p>
<p>The important equation here is</p>
<p>$$
G_{1y}(f) = H_{1y}(f) G_{11}(f) + H_{2y}(f) L_{12}(f) G_{11}(f)
$$</p>
<p>Notice that</p>
<p>$$
L_{12}(f) G_{11}(f) = G_{12}(f)
$$</p>
<p>so we can write</p>
<p>$$
G_{1y}(f) = H_{1y}(f) G_{11}(f) + H_{2y}(f) G_{12}(f)
$$</p>
<p>A very similar method could be used for \( G_{2y}(f) \).</p>
<p>$$
G_{2y}(f) = H_{1y}(f) G_{21}(f) + H_{2y}(f) G_{22}(f)
$$</p>
<p>This gives us two equations with only two unknows: \( H_{1y}(f) \) and \( H_{2y}(f) \), the two frequency responses of the system. We can calculate all the spectral functions here.</p>
<p>We can solve these simultaneously in matrix form for each discrete frequency \( f_{i} \).</p>
<p>$$
\begin{bmatrix}
G_{11}(f_{i}) &amp; G_{12}(f_{i}) \\
G_{21}(f_{i}) &amp; G_{22}(f_{i})
\end{bmatrix}
\begin{bmatrix}
H_{1y}(f_{i}) \\ H_{2y}(f_{i})
\end{bmatrix}
=
\begin{bmatrix}
G_{1y}(f_{i}) \\ G_{2y}(f_{i})
\end{bmatrix}
$$</p>
<p>$$
\begin{bmatrix}
H_{1y}(f_{i}) \\ H_{2y}(f_{i})
\end{bmatrix}
=
\begin{bmatrix}
G_{11}(f_{i}) &amp; G_{12}(f_{i}) \\
G_{21}(f_{i}) &amp; G_{22}(f_{i})
\end{bmatrix} ^{-1}
\begin{bmatrix}
G_{1y}(f_{i}) \\ G_{2y}(f_{i})
\end{bmatrix}
$$</p>
<p>This finally gives us our conditioned frequency responses. We can also extend this idea to an arbitrary number of inputs.</p>
<h2 id="an-example-revisited">An example, revisited<a hidden class="anchor" aria-hidden="true" href="#an-example-revisited">#</a></h2>
<p>Let&rsquo;s go back to the example we started this all with and take a closer look at how the system was
defined.</p>
<p><em><strong>TO BE CONTINUED</strong></em></p>
<h2 id="references">References<a hidden class="anchor" aria-hidden="true" href="#references">#</a></h2>
<p>[1] <a href="https://www.youtube.com/watch?v=hOvE8puBZK4&t=812s">What is Autocorrelation?</a></p>
<p>[2] Bendat, Julius S., and Allan G. Piersol. Random data: analysis and measurement procedures. John Wiley &amp; Sons, 2011.</p>
<p>[3] Tischler, Mark B., and Robert K. Remple. Aircraft and rotorcraft system identification. Reston, VA: American Institute of Aeronautics and Astronautics, 2012.</p>
<p>[4] Otnes, Robert K. &ldquo;Digital time series analysis.&rdquo; John Wiley &amp; Sons, (1972).</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/blog/tags/frequency-response/">Frequency Response</a></li>
      <li><a href="http://localhost:1313/blog/tags/control/">Control</a></li>
      <li><a href="http://localhost:1313/blog/tags/system-identification/">System Identification</a></li>
      <li><a href="http://localhost:1313/blog/tags/aerospace/">Aerospace</a></li>
      <li><a href="http://localhost:1313/blog/tags/signal-processing/">Signal Processing</a></li>
    </ul>
<nav class="paginav">
  <a class="next" href="http://localhost:1313/blog/posts/rk45/rk45/">
    <span class="title">Next »</span>
    <br>
    <span>An Engineer&#39;s Guide to the Runge-Kutta (RK45) Method</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Conditioned Frequency Responses on x"
            href="https://x.com/intent/tweet/?text=Conditioned%20Frequency%20Responses&amp;url=http%3a%2f%2flocalhost%3a1313%2fblog%2fposts%2fconditionedfrequencyresponses%2fconditionedfrequencyresponses%2f&amp;hashtags=frequencyresponse%2ccontrol%2csystemidentification%2caerospace%2csignalprocessing">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Conditioned Frequency Responses on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fblog%2fposts%2fconditionedfrequencyresponses%2fconditionedfrequencyresponses%2f&amp;title=Conditioned%20Frequency%20Responses&amp;summary=Conditioned%20Frequency%20Responses&amp;source=http%3a%2f%2flocalhost%3a1313%2fblog%2fposts%2fconditionedfrequencyresponses%2fconditionedfrequencyresponses%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Conditioned Frequency Responses on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fblog%2fposts%2fconditionedfrequencyresponses%2fconditionedfrequencyresponses%2f&title=Conditioned%20Frequency%20Responses">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Conditioned Frequency Responses on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fblog%2fposts%2fconditionedfrequencyresponses%2fconditionedfrequencyresponses%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Conditioned Frequency Responses on whatsapp"
            href="https://api.whatsapp.com/send?text=Conditioned%20Frequency%20Responses%20-%20http%3a%2f%2flocalhost%3a1313%2fblog%2fposts%2fconditionedfrequencyresponses%2fconditionedfrequencyresponses%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Conditioned Frequency Responses on telegram"
            href="https://telegram.me/share/url?text=Conditioned%20Frequency%20Responses&amp;url=http%3a%2f%2flocalhost%3a1313%2fblog%2fposts%2fconditionedfrequencyresponses%2fconditionedfrequencyresponses%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Conditioned Frequency Responses on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Conditioned%20Frequency%20Responses&u=http%3a%2f%2flocalhost%3a1313%2fblog%2fposts%2fconditionedfrequencyresponses%2fconditionedfrequencyresponses%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/blog/">simmeon&#39;s blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
